MODULE module_nonRot_gad_siem6


CONTAINS

!===============================================================================
!
!  Siemens 6 MW Turbine
!  D = 154 m
!===============================================================================

!=========================================================================

FUNCTION calc_ct_p_siem6( x ) result( ct_p )

!_________________________________________________________________________
!
! Data from Siemens 6 MW
! x =  wind speed
!_________________________________________________________________________


  REAL, INTENT( in ) :: x

  INTEGER, PARAMETER :: nws = 45

  REAL, DIMENSION( 0:nws-1 ) :: ws
  REAL, DIMENSION( 0:nws-1 ) :: CT
  REAL, DIMENSION( 0:nws-1 ) :: P


  real, dimension( 2 )  :: ct_p

  INTEGER :: i

  ct_p(1) = 0.0
  ct_p(2) = 0.0

! Wind speed
ws(0) = 3.000000
ws(1) = 3.500000
ws(2) = 4.000000
ws(3) = 4.500000
ws(4) = 5.000000
ws(5) = 5.500000
ws(6) = 6.000000
ws(7) = 6.500000
ws(8) = 7.000000
ws(9) = 7.500000
ws(10) = 8.000000
ws(11) = 8.500000
ws(12) = 9.000000
ws(13) = 9.500000
ws(14) = 10.000000
ws(15) = 10.500000
ws(16) = 11.000000
ws(17) = 11.500000
ws(18) = 12.000000
ws(19) = 12.500000
ws(20) = 13.000000
ws(21) = 13.500000
ws(22) = 14.000000
ws(23) = 14.500000
ws(24) = 15.000000
ws(25) = 15.500000
ws(26) = 16.000000
ws(27) = 16.500000
ws(28) = 17.000000
ws(29) = 17.500000
ws(30) = 18.000000
ws(31) = 18.500000
ws(32) = 19.000000
ws(33) = 19.500000
ws(34) = 20.000000
ws(35) = 20.500000
ws(36) = 21.000000
ws(37) = 21.500000
ws(38) = 22.000000
ws(39) = 22.500000
ws(40) = 23.000000
ws(41) = 23.500000
ws(42) = 24.000000
ws(43) = 24.500000
ws(44) = 25.000000

! Thrust coefficient
CT(0) = 0.978000
CT(1) = 0.958000
CT(2) = 0.927000
CT(3) = 0.901000
CT(4) = 0.880000
CT(5) = 0.869000
CT(6) = 0.861000
CT(7) = 0.856000
CT(8) = 0.851000
CT(9) = 0.846000
CT(10) = 0.836000
CT(11) = 0.820000
CT(12) = 0.797000
CT(13) = 0.765000
CT(14) = 0.723000
CT(15) = 0.670000
CT(16) = 0.607000
CT(17) = 0.534000
CT(18) = 0.462000
CT(19) = 0.400000
CT(20) = 0.347000
CT(21) = 0.305000
CT(22) = 0.270000
CT(23) = 0.241000
CT(24) = 0.216000
CT(25) = 0.195000
CT(26) = 0.177000
CT(27) = 0.162000
CT(28) = 0.148000
CT(29) = 0.136000
CT(30) = 0.125000
CT(31) = 0.116000
CT(32) = 0.107000
CT(33) = 0.099000
CT(34) = 0.093000
CT(35) = 0.087000
CT(36) = 0.081000
CT(37) = 0.076000
CT(38) = 0.071000
CT(39) = 0.067000
CT(40) = 0.063000
CT(41) = 0.060000
CT(42) = 0.056000
CT(43) = 0.053000
CT(44) = 0.051000

! Power Coefficient
P(0) = 0.337623
P(1) = 0.393540
P(2) = 0.384848
P(3) = 0.414093
P(4) = 0.406706
P(5) = 0.428844
P(6) = 0.425275
P(7) = 0.434870
P(8) = 0.428550
P(9) = 0.436728
P(10) = 0.432611
P(11) = 0.434532
P(12) = 0.428281
P(13) = 0.422070
P(14) = 0.411527
P(15) = 0.389527
P(16) = 0.368389
P(17) = 0.332051
P(18) = 0.300746
P(19) = 0.267495
P(20) = 0.239059
P(21) = 0.213593
P(22) = 0.191627
P(23) = 0.172494
P(24) = 0.155826
P(25) = 0.141227
P(26) = 0.128397
P(27) = 0.117074
P(28) = 0.107045
P(29) = 0.098130
P(30) = 0.090177
P(31) = 0.083061
P(32) = 0.076675
P(33) = 0.070927
P(34) = 0.065739
P(35) = 0.061045
P(36) = 0.056788
P(37) = 0.052917
P(38) = 0.049391
P(39) = 0.046171
P(40) = 0.043225
P(41) = 0.040524
P(42) = 0.038043
P(43) = 0.035761
P(44) = 0.033658

  DO i = 1,nws-1
     
     IF ( ( x .GE. ws(i-1) ) .AND. ( x .LT. ws(i) ) ) THEN
        ct_p(1) = CT(i-1) + (x - ws(i-1))*( ( CT(i) - CT(i-1) )/( ws(i) - ws(i-1) ) )
        ct_p(2) = P(i-1) + (x - ws(i-1))*( ( P(i) - P(i-1) )/( ws(i) - ws(i-1) ) )
        GOTO 1
     ENDIF

  END DO
 
  IF ( x .LT. ws(0) ) THEN
      ct_p(1) = 0.0
      ct_p(2) = 0.0
  ENDIF

  IF ( x .GT. ws(nws-1) ) THEN
      ct_p(1) = 0.0
      ct_p(2) = 0.0
  ENDIF
 

1 CONTINUE
 
!_________________________________________________________________________

END FUNCTION calc_ct_p_siem6
!_________________________________________________________________________
 


END MODULE module_nonRot_gad_siem6

