MODULE module_nonRot_gad_ves3


CONTAINS

!===============================================================================
!
!  Vestas 3 MW Turbine
!  D = 112 m
!===============================================================================

!=========================================================================

FUNCTION calc_ct_p_ves3( x ) result( ct_p )

!_________________________________________________________________________
!
! Data from Vestas 3 MW
! x =  wind speed
!_________________________________________________________________________


  REAL, INTENT( in ) :: x

  INTEGER, PARAMETER :: nws = 45

  REAL, DIMENSION( 0:nws-1 ) :: ws
  REAL, DIMENSION( 0:nws-1 ) :: CT
  REAL, DIMENSION( 0:nws-1 ) :: P


  real, dimension( 2 )  :: ct_p

  INTEGER :: i

  ct_p(1) = 0.0
  ct_p(2) = 0.0

! Wind speed
ws(0) = 3.000000
ws(1) = 3.500000
ws(2) = 4.000000
ws(3) = 4.500000
ws(4) = 5.000000
ws(5) = 5.500000
ws(6) = 6.000000
ws(7) = 6.500000
ws(8) = 7.000000
ws(9) = 7.500000
ws(10) = 8.000000
ws(11) = 8.500000
ws(12) = 9.000000
ws(13) = 9.500000
ws(14) = 10.000000
ws(15) = 10.500000
ws(16) = 11.000000
ws(17) = 11.500000
ws(18) = 12.000000
ws(19) = 12.500000
ws(20) = 13.000000
ws(21) = 13.500000
ws(22) = 14.000000
ws(23) = 14.500000
ws(24) = 15.000000
ws(25) = 15.500000
ws(26) = 16.000000
ws(27) = 16.500000
ws(28) = 17.000000
ws(29) = 17.500000
ws(30) = 18.000000
ws(31) = 18.500000
ws(32) = 19.000000
ws(33) = 19.500000
ws(34) = 20.000000
ws(35) = 20.500000
ws(36) = 21.000000
ws(37) = 21.500000
ws(38) = 22.000000
ws(39) = 22.500000
ws(40) = 23.000000
ws(41) = 23.500000
ws(42) = 24.000000
ws(43) = 24.500000
ws(44) = 25.000000

! Thrust coefficient
CT(0) = 0.950000
CT(1) = 0.923000
CT(2) = 0.899000
CT(3) = 0.864000
CT(4) = 0.836000
CT(5) = 0.822000
CT(6) = 0.817000
CT(7) = 0.813000
CT(8) = 0.809000
CT(9) = 0.804000
CT(10) = 0.800000
CT(11) = 0.795000
CT(12) = 0.788000
CT(13) = 0.764000
CT(14) = 0.714000
CT(15) = 0.636000
CT(16) = 0.549000
CT(17) = 0.463000
CT(18) = 0.396000
CT(19) = 0.343000
CT(20) = 0.300000
CT(21) = 0.265000
CT(22) = 0.236000
CT(23) = 0.211000
CT(24) = 0.190000
CT(25) = 0.172000
CT(26) = 0.156000
CT(27) = 0.142000
CT(28) = 0.130000
CT(29) = 0.120000
CT(30) = 0.110000
CT(31) = 0.102000
CT(32) = 0.095000
CT(33) = 0.088000
CT(34) = 0.082000
CT(35) = 0.076000
CT(36) = 0.071000
CT(37) = 0.067000
CT(38) = 0.063000
CT(39) = 0.059000
CT(40) = 0.056000
CT(41) = 0.053000
CT(42) = 0.050000
CT(43) = 0.047000
CT(44) = 0.045000

! Power Coefficient
P(0) = 0.073652
P(1) = 0.204852
P(2) = 0.313309
P(3) = 0.372807
P(4) = 0.401699
P(5) = 0.418340
P(6) = 0.428870
P(7) = 0.436281
P(8) = 0.441591
P(9) = 0.445055
P(10) = 0.447631
P(11) = 0.448479
P(12) = 0.448278
P(13) = 0.444361
P(14) = 0.430037
P(15) = 0.401544
P(16) = 0.367417
P(17) = 0.325142
P(18) = 0.287320
P(19) = 0.254542
P(20) = 0.226287
P(21) = 0.202064
P(22) = 0.181178
P(23) = 0.163074
P(24) = 0.147304
P(25) = 0.133504
P(26) = 0.121375
P(27) = 0.110672
P(28) = 0.101191
P(29) = 0.092763
P(30) = 0.085246
P(31) = 0.078519
P(32) = 0.072482
P(33) = 0.067048
P(34) = 0.062144
P(35) = 0.057707
P(36) = 0.053682
P(37) = 0.050023
P(38) = 0.046690
P(39) = 0.043646
P(40) = 0.040861
P(41) = 0.038308
P(42) = 0.035963
P(43) = 0.033806
P(44) = 0.031818

  DO i = 1,nws-1
     
     IF ( ( x .GE. ws(i-1) ) .AND. ( x .LT. ws(i) ) ) THEN
        ct_p(1) = CT(i-1) + (x - ws(i-1))*( ( CT(i) - CT(i-1) )/( ws(i) - ws(i-1) ) )
        ct_p(2) = P(i-1) + (x - ws(i-1))*( ( P(i) - P(i-1) )/( ws(i) - ws(i-1) ) )
        GOTO 1
     ENDIF

  END DO
 
  IF ( x .LT. ws(0) ) THEN
      ct_p(1) = 0.0
      ct_p(2) = 0.0
  ENDIF

  IF ( x .GT. ws(nws-1) ) THEN
      ct_p(1) = 0.0
      ct_p(2) = 0.0
  ENDIF
 

1 CONTINUE
 
!_________________________________________________________________________

END FUNCTION calc_ct_p_ves3
!_________________________________________________________________________
 


END MODULE module_nonRot_gad_ves3

