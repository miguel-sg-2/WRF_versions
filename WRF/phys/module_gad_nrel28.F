MODULE module_gad_nrel28

REAL, PARAMETER :: pi=3.1415926535897932384626433

CONTAINS

!===============================================================================
!
!  NREL 2.8MW Turbine 
! hub_height: 88.5, rotor_diameter: 127.0; hub diameter: 5.6388; blade length = 60.6806
!
!===============================================================================

!=========================================================================

FUNCTION calc_rpm_nrel28( ws ) result( rpm )

!_________________________________________________________________________
!
! Data from NREL-2.8-127.csv
!_________________________________________________________________________


  REAL, INTENT( in ) ::ws
  REAL :: rpm

  rpm = 0.0

  ! Polynomial fit to rotational speed of turbine [rpm]  
  IF ( ws .LT. 4.3 ) THEN 
      rpm = 5
  ELSEIF ( ws .GT. 9.6 ) THEN 
      rpm = 12.0388027
  ELSE
      rpm = 1.20205099*ws + 0.01149519
  ENDIF


!_________________________________________________________________________

END FUNCTION calc_rpm_nrel28
!_________________________________________________________________________
 
!=========================================================================

FUNCTION calc_pitch_nrel28( ws ) RESULT( pitch )

!_________________________________________________________________________
!
! Data from NREL-2.8-127.csv
!_________________________________________________________________________
 
  REAL, INTENT( IN ) :: ws


  REAL :: pitch

  ! Initialize output
  pitch = 0.0

  ! Polynomial fit to blade pitch angle [deg]  
  IF ( ws .LT. 7.87 ) THEN 
      pitch = 0
  ELSE
      pitch = 0.00186237850*(ws**3) - 0.132264795*(ws**2) + 4.21893187*ws - 24.7456775
  ENDIF

!_________________________________________________________________________

END FUNCTION calc_pitch_nrel28
!_________________________________________________________________________


FUNCTION calc_fnft_nrel28( v0, rho, blades, bladelen, diameter,           &
                          radius, pitchdeg, rpm, dscale, cscale)         &
                          result( fnft )
!
!  --v0       - "free stream" velocity normal to the turbine rotor plane, [m/s]
!  --rho      - air density, [kg/m^3]
!  --blades   - number of turbine blades, [non-dimensional]
!  --diameter - turbine rotor diameter, [m]
!  --xcoord   - streamwise coordinate of the grid point with respect to
!               local coordinate system with the origin at the turbine hub, [m]
!  --ycoord   - cross-stream coordinate of the grid point with respect to
!               local coordinate system with the origin at the turbine hub, [m]
!  --zcoord   - vertical coordinate of the grid point with respect to
!               local coordinate system with the origin at the turbine hub, [m]
!
!  --fnft     - one-dimensional array (two members) with FUNCTION output
!               specific normal and tangential forces per unit area, [N/m^2]
!
     real, intent( in ) :: v0, rho, blades, bladelen, diameter
     real, intent( in ) :: dscale, cscale 
     real, intent( in ) :: radius
     real, intent( in ) :: rpm
     real, intent( in ) :: pitchdeg
     real, dimension( 2 )  :: fnft
     real               :: rps, omega 
     real               :: radmax, radmin
     real               :: an, at
     real               :: anold, atold
     real               :: cord
     real               :: twist
     real               :: xi, xideg, beta, betadeg, psi, psideg
     real               :: vn, vt
     real               :: cl, cd
     real               :: cn, ct
     real               :: solid
     real               :: fac1, fac2, tiploss, hubloss, lossfac
     real               :: vr
     real               :: lift, drag
     real               :: fn, ft
     real               :: epsi, epscrit
     real               :: cd_nac
     integer            :: iter, itmax
!
     rps   = rpm/60.0
     omega = 2.0*pi*rps
!
     radmax = 0.5*diameter
     radmin = radmax - bladelen
!

  fnft(1) = 0.0
  fnft(2) = 0.0

  IF (radius .LT. radmax) THEN !JDM
     
     IF (radius .GT. radmin) THEN !JDM    !! MSG CHANGED THIS FROM .GE.

        an = 0.0
        at = 0.0
!
        iter = 0
        epsi = 1.0        
        epscrit = 1.e-5
        itmax   = 20
!
!    --Incidence angle

        xideg = calc_twist_nrel28( radius/dscale ) + pitchdeg
        xi    = xideg*pi/180.0
!
!    --Cord length 

        cord  = cscale * calc_chord_nrel28( radius/dscale )
!
!    --Compute induction factors an and at iteratively

        do while ( ( epsi .gt. epscrit ) .and. ( iter .lt. itmax ) ) 
!
           iter = iter + 1
!
!       --Normal and tangential velocity components

           an = 0.02 !JDM This is just the tip loss component of an. This was computed using the
                     !    IDL code as the difference between an computed with and without tip loss
                     !    across the power curve. The value of 0.02 was nearly constant.

           vn = v0*( 1.0 - an )
           vt = omega*radius*( 1.0 + at ) 
 
!       --Advance angle 
  
           psi    = atan2(vn,vt)
           psideg = psi*180.0/pi

! print*,'iter',iter
! print*,'v0,  omega, radius',v0,omega,radius
! print*,'vn, at, vt',vn,at,vt
! print*,'psi',psi
! print*,'------'

!       --Incidence angle  
 
           beta    = psi - xi
           betadeg = beta*180.0/pi

!       --Lift and drag coefficients  
     
           cl = calc_cl_nrel28( radius/dscale, betadeg )
           cd = calc_cd_nrel28( radius/dscale, betadeg )
  
!       --Normal and tangential force coefficients     
  
           cn = cl*cos( psi ) + cd*sin( psi )
           ct = cl*sin( psi ) - cd*cos( psi )

!       --Solidity factor

           solid = cord*blades / ( 2.0*pi*radius )

!       --Tip and hub loss

!          When psi < 0, fac1 and fac 2 can give bizarre answers, and resulting in tip and hub loss terms - NaN.
!          Some logic should be added to keep things from going crazy
           
!          RSA update: the argument of acos should have an abs. value <= 1. When psi
!          is negative, fac1 and/or fac2 are negative, causing exp(-fac) to be a
!          large positive number, causing acos to return NaN. When psi is positive, fac1 and fac2 are
!          positive, such that exp(-fac) is small and positive, which is ok.
!          Thus, we have added logic around the calls to calc_fnft above such
!          that when v0 < 0 (ie psi < 0), this function is not called and the
!          force is set to 0. The turbine should still yaw into place eventually.

           if ( abs( psi ) .gt. 0.001 ) then

              fac1 = blades / 2.0*( radmax - radius ) / ( radius*sin( psi ) )
              fac2 = blades / 2.0*( radius - radmin ) / ( radmin*sin( psi ) )

              tiploss = (2.0/pi)*acos( exp( -fac1 ) )
              hubloss = (2.0/pi)*acos( exp( -fac2 ) )

              lossfac = tiploss*hubloss

!             --Induction factors

              anold = an
              atold = at

!JDM             an = ( 1. + 4.0*lossfac*sin( psi )*sin( psi )/ ( solid*cn ) )**(-1.0)

              at = ( 4.0*lossfac*sin( psi )*cos( psi )/ ( solid*ct ) - 1.0 )**(-1.0)

! print*,'inside of iteration'
! print*,'iter',iter
! print*,'omega, radius, radmin, radmax',omega,radius,radmin,radmax
! print*,'v0, vn, vt, an, at',v0,vn,vt,an,at
! print*,'psi, fac1, fac2',psi,fac1,fac2
! print*,'tiploss, hubloss, lossfac',tiploss,hubloss,lossfac
! print*,'------'

          else

             anold = an
             atold = at

             an = 0.0
             at = 0.0

!print*,'what am I doing in here???'

          endif

!       --Convergence criteria

           epsi = sqrt( ( anold - an )**2.0 + ( atold - at )**2.0 )
  
        end do

!print*,'radius,radmax,radmin',radius,radmax,radmin
!print*,'radius - radmin',radius - radmin
!print*,'fac1,fac2',fac1,fac2
!print*,'psi,sin(psi)',psi,sin(psi)
!print*,'tiploss,hubloss',tiploss,hubloss
!print*,'cl,cd',cl,cd
!print*,'cn,ct',cn,ct

!    --Normal and tangential velocity components

       vn = v0*( 1.0 - an )

       vt = omega*radius*( 1.0 + at ) 

!    --Relative velocity

       vr = sqrt( vn*vn + vt*vt ) 
! 
!    --Advance angle   

       psi    = atan2(vn,vt)
       psideg = psi*180.0/pi
!
!    --Incidence angle   

       beta    = psi - xi
       betadeg = beta*180.0/pi

! print*,'outside of iteration'
! print*,'v0, vn, at, vt',v0,vn,at,vt
! print*,'psideg, betadeg',psideg,betadeg
! print*,'------'

!    --Lift and drag coefficients     
  
       cl = calc_cl_nrel28( radius/dscale, betadeg )
       cd = calc_cd_nrel28( radius/dscale, betadeg )

!    --Lift and drag forces

       lift = 0.5*rho*vr*vr*cord*cl 
       drag = 0.5*rho*vr*vr*cord*cd 

!    --Specific normal and tangential forces

       fn = lift*cos( psi ) + drag*sin( psi )
       ft = lift*sin( psi ) - drag*cos( psi )

!       print*,'psi',psideg

       fn = blades*fn/(2.0*pi*radius)
       ft = blades*ft/(2.0*pi*radius)

       if( fn .lt. 0.0 ) fn = 0.0
       if( ft .lt. 0.0 ) ft = 0.0

       fnft(1) = fn
       fnft(2) = ft              

!print*,'radius,radmax,radmin',radius,radmax,radmin
!print*,'radius - radmin',radius - radmin
!print*,'fac1,fac2',fac1,fac2
!print*,'psi,sin(psi)',psi,sin(psi)
!print*,'tiploss,hubloss',tiploss,hubloss
!print*,'cl,cd',cl,cd
!print*,'cn,ct',cn,ct
!print*,'fn,ft',fn,ft


     ENDIF !radius .GE. radmin

  ENDIF   !radius .LT. radmax

END FUNCTION calc_fnft_nrel28


!=========================================================================

FUNCTION calc_twist_nrel28( x ) RESULT( twist )
!_________________________________________________________________________
!
! Computes blade twist as a function of radial distance from hub center
!_________________________________________________________________________
  
  REAL, INTENT( IN ) :: x

  REAL, PARAMETER :: ns = 5

  REAL, DIMENSION( 0:ns-1 ) :: rf
  REAL, DIMENSION( 0:ns-1 ) :: r
  REAL, DIMENSION( 0:ns-1 ) :: t
  REAL :: xx
  REAL :: twist 
  REAL :: r_norm 
  REAL :: rad 
  INTEGER :: i

  twist = 0.0
  r_norm = 0.0
  xx = x - 2.8194 ! Remove hub radius (r_hub = 2.8194) because chord is a function of blade length only
  r_norm = xx/60.6806 ! Normalized radius (radial position/blade length)  


  twist = -794.52991035*(r_norm**6) +  2706.04655326*(r_norm**5)  - 3624.95990194*(r_norm**4)  + 2344.50153446*(r_norm**3) - 681.6467168*(r_norm**2) +  27.7665712*r_norm +  19.35411953


     IF ( r_norm .GT. 1) THEN
        PRINT*,'—————————————'
        PRINT*,'radius > blade length in calc_twist_nrel28.pro'
        PRINT*,'—————————————'
        STOP
     ENDIF
     
     IF ( r_norm .LT. 0 ) THEN
        PRINT*,'—————————————'
        PRINT*,'radius < 0 in calc_twist_nrel28.pro'
        PRINT*,'—————————————'
        STOP
     ENDIF 
     
  
!PRINT*,x,twist
  
!_________________________________________________________________________
  
END FUNCTION calc_twist_nrel28
!_________________________________________________________________________


!=========================================================================

FUNCTION calc_chord_nrel28( x ) RESULT( chord )
!_________________________________________________________________________
!
! Data from ./WISDEM/NREL-2p8-127.yaml
!_________________________________________________________________________
 

  REAL, INTENT( IN ) :: x
  REAL :: xx
  REAL :: chord 
  REAL :: r_norm 

  chord = 0.0
  r_norm = 0.0
  xx = x - 2.8194 ! Remove hub radius (r_hub = 2.8194) because chord is a function of blade length only
  r_norm = xx/60.6806 ! Normalized radius (radial position/blade length)  

  chord = 228.28720819*(r_norm**7) - 945.23726225*(r_norm**6) + 1523.46565329*(r_norm**5) - 1274.02848627*(r_norm**4) + 635.18637149*(r_norm**3) - 205.08440289*(r_norm**2) + 35.09675996*r_norm + 2.44207086

  IF ( r_norm .GT. 1 ) THEN 
     PRINT*,'—————————————'
     PRINT*,'radius > blade length in calc_chord_nrel28.pro'
     PRINT*,'—————————————'
     STOP
  ENDIF
  IF ( r_norm .LT. 0 ) THEN 
     PRINT*,'—————————————'
     PRINT*,'radius < 0 in calc_chord_nrel28.pro'
     PRINT*,'—————————————'
     STOP
  ENDIF
   
!_________________________________________________________________________
  
END FUNCTION calc_chord_nrel28
!_________________________________________________________________________


!=========================================================================

FUNCTION calc_cl_nrel28( xx,y ) RESULT( cl )
!_________________________________________________________________________
!
! Calls appropriate airfoil section table depending upon radial distance
! from blade root. Data from GE-PSU/GE.inp
!
! rf = RAIRF = Section boundaries for different blade airfoil lookup tables
! ns = RAIRF + 1, endpoint values was added for error checking
!
! x = radial distance from hub center
! y = angle of attack
!_________________________________________________________________________
  
  REAL, INTENT( IN ) :: xx,y

  REAL, PARAMETER :: ns = 8

  REAL, DIMENSION( 0:ns-1 ) :: r,rf
  REAL :: x

  REAL :: cl
  REAL :: rad 
  INTEGER :: i

  cl = 0.0

!!!
  x = xx - 2.8194 ! Remove hub radius (r_hub = 2.8194) because chord is a function of blade length only
  rad = 60.6806

  

  rf( 0) = 0.0
  rf( 1) = 0.02
  rf( 2) = 0.1371
  rf( 3) = 0.2118
  rf( 4) = 0.3188
  rf( 5) = 0.5236
  rf( 6) = 0.6781
  rf( 7) = 1.0

!!!
  
  DO i = 0,ns-1
     r(i) = rad*rf(i)
  ENDDO
  
  IF ( ( x .GT. r( 0) ) .AND. ( x .LE. r( 1) ) ) THEN
       cl = calc_cl1_nrel28(y)
     ELSEIF ( ( x .GT. r( 1) ) .AND. ( x .LE. r( 2) ) ) THEN
       cl = calc_cl2_nrel28(y)
     ELSEIF ( ( x .GT. r( 2) ) .AND. ( x .LE. r( 3) ) ) THEN
       cl = calc_cl3_nrel28(y)
     ELSEIF ( ( x .GT. r( 3) ) .AND. ( x .LE. r( 4) ) ) THEN
       cl = calc_cl4_nrel28(y)
     ELSEIF ( ( x .GT. r( 4) ) .AND. ( x .LE. r( 5) ) ) THEN
       cl = calc_cl5_nrel28(y)
     ELSEIF ( ( x .GT. r( 5) ) .AND. ( x .LE. r( 6) ) ) THEN
       cl = calc_cl6_nrel28(y)
     ELSEIF ( ( x .GT. r( 6) ) .AND. ( x .LE. r( 7) ) ) THEN
       cl = calc_cl7_nrel28(y)
  ENDIF
  
  IF ( x .LT. r(0) ) THEN 
     PRINT*,'—————————————'
     PRINT*,'radius',x,' less than blade root',r(0),' in calc_cl_nrel28.pro'
     PRINT*,'—————————————'
     STOP
  ENDIF
  IF ( x .GT. r(ns-1) ) THEN 
     PRINT*,'—————————————'
     PRINT*,'radius greater than blade length in calc_cl_nrel28.pro'
     PRINT*,'—————————————'
     STOP
  ENDIF
  
!_________________________________________________________________________
  
END FUNCTION calc_cl_nrel28
!_________________________________________________________________________

!=========================================================================

FUNCTION calc_cd_nrel28( xx,y ) RESULT( cd )
!_________________________________________________________________________
!
! Calls appropriate airfoil section table depending upon radial distance
! from blade root. Data from GE-PSU/GE.inp
!
! rf = RAIRF = Section boundaries for different blade airfoil lookup tables
! ns = RAIRF + 1, endpoint values was added for error checking
!
! x = radial distance from hub center
! y = angle of attack
!_________________________________________________________________________
  
  REAL, INTENT( IN ) :: xx,y

  REAL, PARAMETER :: ns = 8

  REAL, DIMENSION( 0:ns-1 ) :: r,rf
  REAL :: x
  REAL :: cd
  REAL :: rad 
  INTEGER :: i

  cd = 0.0
!!  
  x = xx - 2.8194 ! Remove hub radius (r_hub = 2.8194) because chord is a function of blade length only
  rad = 60.6806

  

  rf( 0) = 0.0
  rf( 1) = 0.02
  rf( 2) = 0.1371
  rf( 3) = 0.2118
  rf( 4) = 0.3188
  rf( 5) = 0.5236
  rf( 6) = 0.6781
  rf( 7) = 1.0
!!  
  DO i = 0,ns-1
     r(i) = rad*rf(i)
  ENDDO

  IF ( ( x .GT. r( 0) ) .AND. (x .LE. r( 1) ) ) THEN
       cd = calc_cd1_nrel28(y)
     ELSEIF ( ( x .GT. r( 1) ) .AND. (x .LE. r( 2) ) ) THEN
       cd = calc_cd2_nrel28(y)
     ELSEIF ( ( x .GT. r( 2) ) .AND. (x .LE. r( 3) ) ) THEN
       cd = calc_cd3_nrel28(y)
     ELSEIF ( ( x .GT. r( 3) ) .AND. (x .LE. r( 4) ) ) THEN
       cd = calc_cd4_nrel28(y)
     ELSEIF ( ( x .GT. r( 4) ) .AND. (x .LE. r( 5) ) ) THEN
       cd = calc_cd5_nrel28(y)
     ELSEIF ( ( x .GT. r( 5) ) .AND. (x .LE. r( 6) ) ) THEN
       cd = calc_cd6_nrel28(y)
     ELSEIF ( ( x .GT. r( 6) ) .AND. (x .LE. r( 7) ) ) THEN
       cd = calc_cd7_nrel28(y)
  ENDIF
  
  IF ( x .LT. r(0) ) THEN
     PRINT*,'—————————————'
     PRINT*,'radius less than blade root in calc_cd_nrel28.pro'
     PRINT*,'—————————————'
     STOP
  ENDIF
  
  IF ( x .GT. r(ns-1) ) THEN
     PRINT*,'—————————————'
     PRINT*,'radius greater than blade length in calc_cd_nrel28.pro'
     PRINT*,'—————————————'
     STOP
  ENDIF
!_________________________________________________________________________
  
END FUNCTION calc_cd_nrel28
!_________________________________________________________________________

!=========================================================================

FUNCTION calc_cl1_nrel28( y ) RESULT( cl1 )
!_________________________________________________________________________
!
! Data from Cylinder
!_________________________________________________________________________
  
  REAL, INTENT( IN ) :: y

  REAL :: cl1

  cl1 = 0.0
!_________________________________________________________________________
  
END FUNCTION calc_cl1_nrel28
!_________________________________________________________________________

!=========================================================================

FUNCTION calc_cl2_nrel28( y ) RESULT( cl2 )
!_________________________________________________________________________
!
! Data from FX77-W-500 airfoil
!_________________________________________________________________________
  
  REAL, INTENT( IN ) :: y

  REAL, PARAMETER :: ns = 145

  REAL, DIMENSION( 0:1,0:ns-1 ) :: cl

  REAL :: cl2
  INTEGER :: i

  cl2 = 0.0

  cl(0:1, 0) = [-179.96604345059157, 0.0]
  cl(0:1, 1) = [-174.99998905707469, 0.22]
  cl(0:1, 2) = [-170.00001556208605, 0.44]
  cl(0:1, 3) = [-164.99998477131788, 0.54655]
  cl(0:1, 4) = [-160.00001127632925, 0.6531]
  cl(0:1, 5) = [-154.99998048556108, 0.62745]
  cl(0:1, 6) = [-150.00000699057244, 0.6018]
  cl(0:1, 7) = [-144.9999761998043, 0.5874]
  cl(0:1, 8) = [-140.00000270481564, 0.573]
  cl(0:1, 9) = [-134.99997191404748, 0.54675]
  cl(0:1, 10) = [-129.99999841905884, 0.5205]
  cl(0:1, 11) = [-125.00002492407022, 0.47605]
  cl(0:1, 12) = [-119.99999413330205, 0.4316]
  cl(0:1, 13) = [-115.0000206383134, 0.36965]
  cl(0:1, 14) = [-109.99998984754525, 0.3077]
  cl(0:1, 15) = [-105.0000163525566, 0.2332]
  cl(0:1, 16) = [-99.99998556178845, 0.1587]
  cl(0:1, 17) = [-95.00001206679983, 0.07935]
  cl(0:1, 18) = [-89.99998127603166, 0.0]
  cl(0:1, 19) = [-85.00000778104302, -0.07935]
  cl(0:1, 20) = [-79.99997699027486, -0.1587]
  cl(0:1, 21) = [-75.00000349528622, -0.2332]
  cl(0:1, 22) = [-69.99997270451807, -0.3077]
  cl(0:1, 23) = [-64.99999920952942, -0.36965]
  cl(0:1, 24) = [-60.00002571454079, -0.4316]
  cl(0:1, 25) = [-54.999994923772626, -0.47605]
  cl(0:1, 26) = [-50.00002142878399, -0.5205]
  cl(0:1, 27) = [-44.99999063801583, -0.54675]
  cl(0:1, 28) = [-40.000017143027186, -0.573]
  cl(0:1, 29) = [-37.999993367564024, -0.57876]
  cl(0:1, 30) = [-36.00002688788037, -0.58452]
  cl(0:1, 31) = [-34.00000311241721, -0.59028]
  cl(0:1, 32) = [-31.999979336954045, -0.59604]
  cl(0:1, 33) = [-30.000012857270395, -0.6018]
  cl(0:1, 34) = [-27.99998908180723, -0.61206]
  cl(0:1, 35) = [-26.000022602123575, -0.62232]
  cl(0:1, 36) = [-23.99999882666041, -0.63258]
  cl(0:1, 37) = [-21.999975051197243, -0.64284]
  cl(0:1, 38) = [-20.000008571513593, -0.6531]
  cl(0:1, 39) = [-19.000025331671768, -0.62655]
  cl(0:1, 40) = [-17.99998479605043, -0.6]
  cl(0:1, 41) = [-17.000001556208606, -0.57345]
  cl(0:1, 42) = [-16.000018316366777, -0.5469]
  cl(0:1, 43) = [-14.99997778074544, -0.52035]
  cl(0:1, 44) = [-13.999994540903614, -0.4938]
  cl(0:1, 45) = [-13.499974273092944, -0.48053]
  cl(0:1, 46) = [-13.000011301061788, -0.46725]
  cl(0:1, 47) = [-12.499991033251119, -0.45398]
  cl(0:1, 48) = [-12.000028061219961, -0.4407]
  cl(0:1, 49) = [-11.500007793409292, -0.42743]
  cl(0:1, 50) = [-10.999987525598621, -0.41415]
  cl(0:1, 51) = [-10.500024553567467, -0.40088]
  cl(0:1, 52) = [-10.000004285756797, -0.3876]
  cl(0:1, 53) = [-9.499984017946128, -0.36131]
  cl(0:1, 54) = [-9.000021045914972, -0.33501]
  cl(0:1, 55) = [-8.500000778104303, -0.30872]
  cl(0:1, 56) = [-7.999980510293632, -0.28242]
  cl(0:1, 57) = [-7.500017538262475, -0.25613]
  cl(0:1, 58) = [-6.999997270451807, -0.22984]
  cl(0:1, 59) = [-6.499977002641137, -0.20354]
  cl(0:1, 60) = [-6.0000140306099805, -0.17725]
  cl(0:1, 61) = [-5.499993762799311, -0.15095]
  cl(0:1, 62) = [-4.999973494988642, -0.12466]
  cl(0:1, 63) = [-4.500010522957486, -0.09836]
  cl(0:1, 64) = [-3.999990255146816, -0.07207]
  cl(0:1, 65) = [-3.50002728311566, -0.04578]
  cl(0:1, 66) = [-3.0000070153049903, -0.00714]
  cl(0:1, 67) = [-2.499986747494321, 0.05]
  cl(0:1, 68) = [-2.0000237754631645, 0.10714]
  cl(0:1, 69) = [-1.5000035076524951, 0.16429]
  cl(0:1, 70) = [-0.9999832398418258, 0.22143]
  cl(0:1, 71) = [-0.5000202678106694, 0.27857]
  cl(0:1, 72) = [0.0, 0.33571]
  cl(0:1, 73) = [0.5000202678106694, 0.39286]
  cl(0:1, 74) = [0.9999832398418258, 0.45]
  cl(0:1, 75) = [1.5000035076524951, 0.50714]
  cl(0:1, 76) = [2.0000237754631645, 0.57]
  cl(0:1, 77) = [2.499986747494321, 0.63667]
  cl(0:1, 78) = [3.0000070153049903, 0.70333]
  cl(0:1, 79) = [3.50002728311566, 0.77]
  cl(0:1, 80) = [3.999990255146816, 0.83667]
  cl(0:1, 81) = [4.500010522957486, 0.90333]
  cl(0:1, 82) = [4.999973494988642, 0.97]
  cl(0:1, 83) = [5.499993762799311, 1.03667]
  cl(0:1, 84) = [6.0000140306099805, 1.09774]
  cl(0:1, 85) = [6.499977002641137, 1.15742]
  cl(0:1, 86) = [6.999997270451807, 1.2171]
  cl(0:1, 87) = [7.500017538262475, 1.27677]
  cl(0:1, 88) = [7.999980510293632, 1.33645]
  cl(0:1, 89) = [8.500000778104303, 1.39613]
  cl(0:1, 90) = [9.000021045914972, 1.44438]
  cl(0:1, 91) = [9.499984017946128, 1.485]
  cl(0:1, 92) = [10.000004285756797, 1.52563]
  cl(0:1, 93) = [10.500024553567467, 1.24]
  cl(0:1, 94) = [10.999987525598621, 1.07325]
  cl(0:1, 95) = [11.500007793409292, 1.04503]
  cl(0:1, 96) = [12.000028061219961, 1.02796]
  cl(0:1, 97) = [12.499991033251119, 1.01711]
  cl(0:1, 98) = [13.000011301061788, 1.00973]
  cl(0:1, 99) = [13.499974273092944, 1.00754]
  cl(0:1, 100) = [13.999994540903614, 1.00722]
  cl(0:1, 101) = [14.99997778074544, 1.00829]
  cl(0:1, 102) = [16.000018316366777, 1.01175]
  cl(0:1, 103) = [17.000001556208606, 0.99385]
  cl(0:1, 104) = [17.99998479605043, 0.97356]
  cl(0:1, 105) = [19.000025331671768, 0.95328]
  cl(0:1, 106) = [20.000008571513593, 0.933]
  cl(0:1, 107) = [21.999975051197243, 0.91836]
  cl(0:1, 108) = [23.99999882666041, 0.90372]
  cl(0:1, 109) = [26.000022602123575, 0.88908]
  cl(0:1, 110) = [27.99998908180723, 0.87444]
  cl(0:1, 111) = [30.000012857270395, 0.8598]
  cl(0:1, 112) = [31.999979336954045, 0.85154]
  cl(0:1, 113) = [34.00000311241721, 0.84328]
  cl(0:1, 114) = [36.00002688788037, 0.83502]
  cl(0:1, 115) = [37.999993367564024, 0.82676]
  cl(0:1, 116) = [40.000017143027186, 0.8185]
  cl(0:1, 117) = [44.99999063801583, 0.781]
  cl(0:1, 118) = [50.00002142878399, 0.7435]
  cl(0:1, 119) = [54.999994923772626, 0.68]
  cl(0:1, 120) = [60.00002571454079, 0.6165]
  cl(0:1, 121) = [64.99999920952942, 0.52805]
  cl(0:1, 122) = [69.99997270451807, 0.4396]
  cl(0:1, 123) = [75.00000349528622, 0.3332]
  cl(0:1, 124) = [79.99997699027486, 0.2268]
  cl(0:1, 125) = [85.00000778104302, 0.1134]
  cl(0:1, 126) = [89.99998127603166, 0.0]
  cl(0:1, 127) = [95.00001206679983, -0.07935]
  cl(0:1, 128) = [99.99998556178845, -0.1587]
  cl(0:1, 129) = [105.0000163525566, -0.2332]
  cl(0:1, 130) = [109.99998984754525, -0.3077]
  cl(0:1, 131) = [115.0000206383134, -0.36965]
  cl(0:1, 132) = [119.99999413330205, -0.4316]
  cl(0:1, 133) = [125.00002492407022, -0.47605]
  cl(0:1, 134) = [129.99999841905884, -0.5205]
  cl(0:1, 135) = [134.99997191404748, -0.54675]
  cl(0:1, 136) = [140.00000270481564, -0.573]
  cl(0:1, 137) = [144.9999761998043, -0.5874]
  cl(0:1, 138) = [150.00000699057244, -0.6018]
  cl(0:1, 139) = [154.99998048556108, -0.62745]
  cl(0:1, 140) = [160.00001127632925, -0.6531]
  cl(0:1, 141) = [164.99998477131788, -0.54655]
  cl(0:1, 142) = [170.00001556208605, -0.44]
  cl(0:1, 143) = [174.99998905707469, -0.22]
  cl(0:1, 144) = [179.96604345059157, 0.0] 

  IF ( y .EQ. cl(0,0) ) cl2 = cl(1,0)
  DO i = 1,ns-1
     IF ( ( y .GT. cl(0,i-1) ) .AND. ( y .LE. cl(0,i) ) ) THEN
        cl2 = cl(1,i-1) + (y - cl(0,i-1))*( ( cl(1,i) - cl(1,i-1) )/( cl(0,i) - cl(0,i-1) ) )
        GOTO 1
     ENDIF
  ENDDO

1 CONTINUE

  IF ( y .LT. cl(0,0) ) THEN
     cl2 = cl(1,0)
  ENDIF
  IF ( y .GT. cl(0,ns-1) ) THEN
     cl2 = cl(1,ns-1)
  ENDIF

!_________________________________________________________________________
  
END FUNCTION calc_cl2_nrel28
!_________________________________________________________________________


!=========================================================================

FUNCTION calc_cl3_nrel28( y ) RESULT( cl3 )
!_________________________________________________________________________
!
! Data from FX77-W-400 airfoil
!_________________________________________________________________________
  
  REAL, INTENT( IN ) :: y

  REAL, PARAMETER :: ns = 145

  REAL, DIMENSION( 0:1,0:ns-1 ) :: cl

  REAL :: cl3
  INTEGER :: i

  cl3 = 0.0
  
!                alpha     CL    
  cl(0:1, 0) = [-179.96604345059157, 0.0]
  cl(0:1, 1) = [-174.99998905707469, 0.24645]
  cl(0:1, 2) = [-170.00001556208605, 0.4929]
  cl(0:1, 3) = [-164.99998477131788, 0.6031]
  cl(0:1, 4) = [-160.00001127632925, 0.7133]
  cl(0:1, 5) = [-154.99998048556108, 0.67505]
  cl(0:1, 6) = [-150.00000699057244, 0.6368]
  cl(0:1, 7) = [-144.9999761998043, 0.61555]
  cl(0:1, 8) = [-140.00000270481564, 0.5943]
  cl(0:1, 9) = [-134.99997191404748, 0.56365]
  cl(0:1, 10) = [-129.99999841905884, 0.533]
  cl(0:1, 11) = [-125.00002492407022, 0.48565]
  cl(0:1, 12) = [-119.99999413330205, 0.4383]
  cl(0:1, 13) = [-115.0000206383134, 0.37445]
  cl(0:1, 14) = [-109.99998984754525, 0.3106]
  cl(0:1, 15) = [-105.0000163525566, 0.235]
  cl(0:1, 16) = [-99.99998556178845, 0.1594]
  cl(0:1, 17) = [-95.00001206679983, 0.0797]
  cl(0:1, 18) = [-89.99998127603166, 0.0]
  cl(0:1, 19) = [-85.00000778104302, -0.0797]
  cl(0:1, 20) = [-79.99997699027486, -0.1594]
  cl(0:1, 21) = [-75.00000349528622, -0.235]
  cl(0:1, 22) = [-69.99997270451807, -0.3106]
  cl(0:1, 23) = [-64.99999920952942, -0.37445]
  cl(0:1, 24) = [-60.00002571454079, -0.4383]
  cl(0:1, 25) = [-54.999994923772626, -0.48565]
  cl(0:1, 26) = [-50.00002142878399, -0.533]
  cl(0:1, 27) = [-44.99999063801583, -0.56365]
  cl(0:1, 28) = [-40.000017143027186, -0.5943]
  cl(0:1, 29) = [-37.999993367564024, -0.6028]
  cl(0:1, 30) = [-36.00002688788037, -0.6113]
  cl(0:1, 31) = [-34.00000311241721, -0.6198]
  cl(0:1, 32) = [-31.999979336954045, -0.6283]
  cl(0:1, 33) = [-30.000012857270395, -0.6368]
  cl(0:1, 34) = [-27.99998908180723, -0.6521]
  cl(0:1, 35) = [-26.000022602123575, -0.6674]
  cl(0:1, 36) = [-23.99999882666041, -0.6827]
  cl(0:1, 37) = [-21.999975051197243, -0.698]
  cl(0:1, 38) = [-20.000008571513593, -0.7133]
  cl(0:1, 39) = [-19.000025331671768, -0.68902]
  cl(0:1, 40) = [-17.99998479605043, -0.66474]
  cl(0:1, 41) = [-17.000001556208606, -0.64046]
  cl(0:1, 42) = [-16.000018316366777, -0.61618]
  cl(0:1, 43) = [-14.99997778074544, -0.5919]
  cl(0:1, 44) = [-13.999994540903614, -0.56762]
  cl(0:1, 45) = [-13.499974273092944, -0.55548]
  cl(0:1, 46) = [-13.000011301061788, -0.54334]
  cl(0:1, 47) = [-12.499991033251119, -0.5312]
  cl(0:1, 48) = [-12.000028061219961, -0.51906]
  cl(0:1, 49) = [-11.500007793409292, -0.50692]
  cl(0:1, 50) = [-10.999987525598621, -0.49478]
  cl(0:1, 51) = [-10.500024553567467, -0.48264]
  cl(0:1, 52) = [-10.000004285756797, -0.4705]
  cl(0:1, 53) = [-9.499984017946128, -0.44398]
  cl(0:1, 54) = [-9.000021045914972, -0.41746]
  cl(0:1, 55) = [-8.500000778104303, -0.39094]
  cl(0:1, 56) = [-7.999980510293632, -0.36441]
  cl(0:1, 57) = [-7.500017538262475, -0.33789]
  cl(0:1, 58) = [-6.999997270451807, -0.31137]
  cl(0:1, 59) = [-6.499977002641137, -0.28485]
  cl(0:1, 60) = [-6.0000140306099805, -0.25833]
  cl(0:1, 61) = [-5.499993762799311, -0.23181]
  cl(0:1, 62) = [-4.999973494988642, -0.20529]
  cl(0:1, 63) = [-4.500010522957486, -0.17876]
  cl(0:1, 64) = [-3.999990255146816, -0.15224]
  cl(0:1, 65) = [-3.50002728311566, -0.12572]
  cl(0:1, 66) = [-3.0000070153049903, -0.0992]
  cl(0:1, 67) = [-2.499986747494321, -0.0312]
  cl(0:1, 68) = [-2.0000237754631645, 0.0368]
  cl(0:1, 69) = [-1.5000035076524951, 0.1048]
  cl(0:1, 70) = [-0.9999832398418258, 0.1728]
  cl(0:1, 71) = [-0.5000202678106694, 0.2408]
  cl(0:1, 72) = [0.0, 0.3088]
  cl(0:1, 73) = [0.5000202678106694, 0.3768]
  cl(0:1, 74) = [0.9999832398418258, 0.4448]
  cl(0:1, 75) = [1.5000035076524951, 0.5128]
  cl(0:1, 76) = [2.0000237754631645, 0.5798]
  cl(0:1, 77) = [2.499986747494321, 0.6462]
  cl(0:1, 78) = [3.0000070153049903, 0.7126]
  cl(0:1, 79) = [3.50002728311566, 0.779]
  cl(0:1, 80) = [3.999990255146816, 0.8454]
  cl(0:1, 81) = [4.500010522957486, 0.9118]
  cl(0:1, 82) = [4.999973494988642, 0.9782]
  cl(0:1, 83) = [5.499993762799311, 1.0446]
  cl(0:1, 84) = [6.0000140306099805, 1.111]
  cl(0:1, 85) = [6.499977002641137, 1.1774]
  cl(0:1, 86) = [6.999997270451807, 1.2438]
  cl(0:1, 87) = [7.500017538262475, 1.3102]
  cl(0:1, 88) = [7.999980510293632, 1.374]
  cl(0:1, 89) = [8.500000778104303, 1.434]
  cl(0:1, 90) = [9.000021045914972, 1.494]
  cl(0:1, 91) = [9.499984017946128, 1.554]
  cl(0:1, 92) = [10.000004285756797, 1.614]
  cl(0:1, 93) = [10.500024553567467, 1.6629]
  cl(0:1, 94) = [10.999987525598621, 1.6953]
  cl(0:1, 95) = [11.500007793409292, 1.7277]
  cl(0:1, 96) = [12.000028061219961, 1.76]
  cl(0:1, 97) = [12.499991033251119, 0.986]
  cl(0:1, 98) = [13.000011301061788, 0.9725]
  cl(0:1, 99) = [13.499974273092944, 0.985]
  cl(0:1, 100) = [13.999994540903614, 0.9975]
  cl(0:1, 101) = [14.99997778074544, 1.054]
  cl(0:1, 102) = [16.000018316366777, 1.1267]
  cl(0:1, 103) = [17.000001556208606, 1.0998]
  cl(0:1, 104) = [17.99998479605043, 1.0729]
  cl(0:1, 105) = [19.000025331671768, 1.046]
  cl(0:1, 106) = [20.000008571513593, 1.0191]
  cl(0:1, 107) = [21.999975051197243, 0.99724]
  cl(0:1, 108) = [23.99999882666041, 0.97538]
  cl(0:1, 109) = [26.000022602123575, 0.95352]
  cl(0:1, 110) = [27.99998908180723, 0.93166]
  cl(0:1, 111) = [30.000012857270395, 0.9098]
  cl(0:1, 112) = [31.999979336954045, 0.89762]
  cl(0:1, 113) = [34.00000311241721, 0.88544]
  cl(0:1, 114) = [36.00002688788037, 0.87326]
  cl(0:1, 115) = [37.999993367564024, 0.86108]
  cl(0:1, 116) = [40.000017143027186, 0.8489]
  cl(0:1, 117) = [44.99999063801583, 0.8052]
  cl(0:1, 118) = [50.00002142878399, 0.7615]
  cl(0:1, 119) = [54.999994923772626, 0.69385]
  cl(0:1, 120) = [60.00002571454079, 0.6262]
  cl(0:1, 121) = [64.99999920952942, 0.53495]
  cl(0:1, 122) = [69.99997270451807, 0.4437]
  cl(0:1, 123) = [75.00000349528622, 0.33575]
  cl(0:1, 124) = [79.99997699027486, 0.2278]
  cl(0:1, 125) = [85.00000778104302, 0.1139]
  cl(0:1, 126) = [89.99998127603166, 0.0]
  cl(0:1, 127) = [95.00001206679983, -0.0797]
  cl(0:1, 128) = [99.99998556178845, -0.1594]
  cl(0:1, 129) = [105.0000163525566, -0.235]
  cl(0:1, 130) = [109.99998984754525, -0.3106]
  cl(0:1, 131) = [115.0000206383134, -0.37445]
  cl(0:1, 132) = [119.99999413330205, -0.4383]
  cl(0:1, 133) = [125.00002492407022, -0.48565]
  cl(0:1, 134) = [129.99999841905884, -0.533]
  cl(0:1, 135) = [134.99997191404748, -0.56365]
  cl(0:1, 136) = [140.00000270481564, -0.5943]
  cl(0:1, 137) = [144.9999761998043, -0.61555]
  cl(0:1, 138) = [150.00000699057244, -0.6368]
  cl(0:1, 139) = [154.99998048556108, -0.67505]
  cl(0:1, 140) = [160.00001127632925, -0.7133]
  cl(0:1, 141) = [164.99998477131788, -0.6031]
  cl(0:1, 142) = [170.00001556208605, -0.4929]
  cl(0:1, 143) = [174.99998905707469, -0.24645]
  cl(0:1, 144) = [179.96604345059157, 0.0]
  
  IF ( y .EQ. cl(0,0) ) cl3 = cl(1,0)
  DO i = 1,ns-1
     IF ( ( y .GT. cl(0,i-1) ) .AND. ( y .LE. cl(0,i) ) ) THEN
        cl3 = cl(1,i-1) + (y - cl(0,i-1))*( ( cl(1,i) - cl(1,i-1) )/( cl(0,i) - cl(0,i-1) ) )
        GOTO 1
     ENDIF
  ENDDO

1 CONTINUE
 
  IF ( y .LT. cl(0,0) ) THEN
     cl3 = cl(1,0)
!     PRINT*,'alpha < tabulated range in calc_cdl_nrel28.pro'
  ENDIF
  IF ( y .GT. cl(0,ns-1) ) THEN
     cl3 = cl(1,ns-1)
!     PRINT*,'alpha > tabulated range in calc_cl3_nrel28.pro'
  ENDIF
  
!PRINT*,y,cl3
  
!_________________________________________________________________________
  
END FUNCTION calc_cl3_nrel28
!_________________________________________________________________________


!=========================================================================

FUNCTION calc_cl4_nrel28( y ) RESULT( cl4 )
!_________________________________________________________________________
!
! Data from DU00-W2-350 airfoil
!_________________________________________________________________________
  
  REAL, INTENT( IN ) :: y

  REAL, PARAMETER :: ns = 145

  REAL, DIMENSION( 0:1,0:ns-1 ) :: cl

  REAL :: cl4
  INTEGER :: i

  cl4 = 0.0
  
!                alpha     CL    
  cl(0:1, 0) = [-179.9087476710785, 0.0]
  cl(0:1, 1) = [-174.99998905707469, 0.216632]
  cl(0:1, 2) = [-170.00001556208605, 0.433263]
  cl(0:1, 3) = [-164.99998477131788, 0.619879]
  cl(0:1, 4) = [-160.00001127632925, 0.806494]
  cl(0:1, 5) = [-154.99998048556108, 0.762784]
  cl(0:1, 6) = [-150.00000699057244, 0.719074]
  cl(0:1, 7) = [-144.9999761998043, 0.694753]
  cl(0:1, 8) = [-140.00000270481564, 0.670431]
  cl(0:1, 9) = [-134.99997191404748, 0.635734]
  cl(0:1, 10) = [-129.99999841905884, 0.601036]
  cl(0:1, 11) = [-125.00002492407022, 0.547548]
  cl(0:1, 12) = [-119.99999413330205, 0.494059]
  cl(0:1, 13) = [-115.0000206383134, 0.422043]
  cl(0:1, 14) = [-109.99998984754525, 0.350027]
  cl(0:1, 15) = [-105.0000163525566, 0.264828]
  cl(0:1, 16) = [-99.99998556178845, 0.179629]
  cl(0:1, 17) = [-95.00001206679983, 0.089815]
  cl(0:1, 18) = [-89.99998127603166, 0.0]
  cl(0:1, 19) = [-85.00000778104302, -0.089815]
  cl(0:1, 20) = [-79.99997699027486, -0.179629]
  cl(0:1, 21) = [-75.00000349528622, -0.264828]
  cl(0:1, 22) = [-69.99997270451807, -0.350027]
  cl(0:1, 23) = [-64.99999920952942, -0.422043]
  cl(0:1, 24) = [-60.00002571454079, -0.494059]
  cl(0:1, 25) = [-54.999994923772626, -0.547548]
  cl(0:1, 26) = [-50.00002142878399, -0.601036]
  cl(0:1, 27) = [-44.99999063801583, -0.639922]
  cl(0:1, 28) = [-40.000017143027186, -0.670431]
  cl(0:1, 29) = [-37.999993367564024, -0.680822]
  cl(0:1, 30) = [-36.00002688788037, -0.690525]
  cl(0:1, 31) = [-34.00000311241721, -0.699855]
  cl(0:1, 32) = [-31.999979336954045, -0.709206]
  cl(0:1, 33) = [-30.000012857270395, -0.719074]
  cl(0:1, 34) = [-27.99998908180723, -0.730093]
  cl(0:1, 35) = [-26.000022602123575, -0.743077]
  cl(0:1, 36) = [-23.99999882666041, -0.759093]
  cl(0:1, 37) = [-21.999975051197243, -0.779575]
  cl(0:1, 38) = [-20.000008571513593, -0.806494]
  cl(0:1, 39) = [-19.000025331671768, -0.791453]
  cl(0:1, 40) = [-17.99998479605043, -0.776411]
  cl(0:1, 41) = [-17.000001556208606, -0.76137]
  cl(0:1, 42) = [-16.000018316366777, -0.746329]
  cl(0:1, 43) = [-14.99997778074544, -0.731288]
  cl(0:1, 44) = [-13.999994540903614, -0.716247]
  cl(0:1, 45) = [-13.499974273092944, -0.708727]
  cl(0:1, 46) = [-13.000011301061788, -0.701206]
  cl(0:1, 47) = [-12.499991033251119, -0.693686]
  cl(0:1, 48) = [-12.000028061219961, -0.686165]
  cl(0:1, 49) = [-11.500007793409292, -0.678644]
  cl(0:1, 50) = [-10.999987525598621, -0.671123]
  cl(0:1, 51) = [-10.500024553567467, -0.663603]
  cl(0:1, 52) = [-10.000004285756797, -0.656082]
  cl(0:1, 53) = [-9.499984017946128, -0.648562]
  cl(0:1, 54) = [-9.000021045914972, -0.641041]
  cl(0:1, 55) = [-8.500000778104303, -0.633521]
  cl(0:1, 56) = [-7.999980510293632, -0.626]
  cl(0:1, 57) = [-7.500017538262475, -0.5835]
  cl(0:1, 58) = [-6.999997270451807, -0.541]
  cl(0:1, 59) = [-6.499977002641137, -0.494]
  cl(0:1, 60) = [-6.0000140306099805, -0.447]
  cl(0:1, 61) = [-5.499993762799311, -0.3955]
  cl(0:1, 62) = [-4.999973494988642, -0.344]
  cl(0:1, 63) = [-4.500010522957486, -0.2885]
  cl(0:1, 64) = [-3.999990255146816, -0.233]
  cl(0:1, 65) = [-3.50002728311566, -0.174]
  cl(0:1, 66) = [-3.0000070153049903, -0.115]
  cl(0:1, 67) = [-2.499986747494321, -0.054]
  cl(0:1, 68) = [-2.0000237754631645, 0.007]
  cl(0:1, 69) = [-1.5000035076524951, 0.07]
  cl(0:1, 70) = [-0.9999832398418258, 0.133]
  cl(0:1, 71) = [-0.5000202678106694, 0.197]
  cl(0:1, 72) = [0.0, 0.261]
  cl(0:1, 73) = [0.5000202678106694, 0.326]
  cl(0:1, 74) = [0.9999832398418258, 0.391]
  cl(0:1, 75) = [1.5000035076524951, 0.4565]
  cl(0:1, 76) = [2.0000237754631645, 0.522]
  cl(0:1, 77) = [2.499986747494321, 0.587]
  cl(0:1, 78) = [3.0000070153049903, 0.652]
  cl(0:1, 79) = [3.50002728311566, 0.7155]
  cl(0:1, 80) = [3.999990255146816, 0.779]
  cl(0:1, 81) = [4.500010522957486, 0.8405]
  cl(0:1, 82) = [4.999973494988642, 0.902]
  cl(0:1, 83) = [5.499993762799311, 0.961]
  cl(0:1, 84) = [6.0000140306099805, 1.02]
  cl(0:1, 85) = [6.499977002641137, 1.0745]
  cl(0:1, 86) = [6.999997270451807, 1.129]
  cl(0:1, 87) = [7.500017538262475, 1.178]
  cl(0:1, 88) = [7.999980510293632, 1.227]
  cl(0:1, 89) = [8.500000778104303, 1.2675]
  cl(0:1, 90) = [9.000021045914972, 1.308]
  cl(0:1, 91) = [9.499984017946128, 1.3385]
  cl(0:1, 92) = [10.000004285756797, 1.369]
  cl(0:1, 93) = [10.500024553567467, 1.381]
  cl(0:1, 94) = [10.999987525598621, 1.393]
  cl(0:1, 95) = [11.500007793409292, 1.3675]
  cl(0:1, 96) = [12.000028061219961, 1.342]
  cl(0:1, 97) = [12.499991033251119, 1.3165]
  cl(0:1, 98) = [13.000011301061788, 1.291]
  cl(0:1, 99) = [13.499974273092944, 1.27]
  cl(0:1, 100) = [13.999994540903614, 1.249]
  cl(0:1, 101) = [14.99997778074544, 1.211]
  cl(0:1, 102) = [16.000018316366777, 1.188]
  cl(0:1, 103) = [17.000001556208606, 1.172]
  cl(0:1, 104) = [17.99998479605043, 1.165]
  cl(0:1, 105) = [19.000025331671768, 1.176]
  cl(0:1, 106) = [20.000008571513593, 1.15213]
  cl(0:1, 107) = [21.999975051197243, 1.11368]
  cl(0:1, 108) = [23.99999882666041, 1.08442]
  cl(0:1, 109) = [26.000022602123575, 1.06154]
  cl(0:1, 110) = [27.99998908180723, 1.04299]
  cl(0:1, 111) = [30.000012857270395, 1.02725]
  cl(0:1, 112) = [31.999979336954045, 1.01315]
  cl(0:1, 113) = [34.00000311241721, 0.999793]
  cl(0:1, 114) = [36.00002688788037, 0.986465]
  cl(0:1, 115) = [37.999993367564024, 0.972603]
  cl(0:1, 116) = [40.000017143027186, 0.957758]
  cl(0:1, 117) = [44.99999063801583, 0.914175]
  cl(0:1, 118) = [50.00002142878399, 0.858623]
  cl(0:1, 119) = [54.999994923772626, 0.782211]
  cl(0:1, 120) = [60.00002571454079, 0.705799]
  cl(0:1, 121) = [64.99999920952942, 0.602919]
  cl(0:1, 122) = [69.99997270451807, 0.500039]
  cl(0:1, 123) = [75.00000349528622, 0.378326]
  cl(0:1, 124) = [79.99997699027486, 0.256613]
  cl(0:1, 125) = [85.00000778104302, 0.128307]
  cl(0:1, 126) = [89.99998127603166, 0.0]
  cl(0:1, 127) = [95.00001206679983, -0.089815]
  cl(0:1, 128) = [99.99998556178845, -0.179629]
  cl(0:1, 129) = [105.0000163525566, -0.264828]
  cl(0:1, 130) = [109.99998984754525, -0.350027]
  cl(0:1, 131) = [115.0000206383134, -0.422043]
  cl(0:1, 132) = [119.99999413330205, -0.494059]
  cl(0:1, 133) = [125.00002492407022, -0.547548]
  cl(0:1, 134) = [129.99999841905884, -0.601036]
  cl(0:1, 135) = [134.99997191404748, -0.635734]
  cl(0:1, 136) = [140.00000270481564, -0.670431]
  cl(0:1, 137) = [144.9999761998043, -0.694753]
  cl(0:1, 138) = [150.00000699057244, -0.719074]
  cl(0:1, 139) = [154.99998048556108, -0.762784]
  cl(0:1, 140) = [160.00001127632925, -0.806494]
  cl(0:1, 141) = [164.99998477131788, -0.604871]
  cl(0:1, 142) = [170.00001556208605, -0.403247]
  cl(0:1, 143) = [174.99998905707469, -0.201624]
  cl(0:1, 144) = [179.9087476710785, 0.0]
  
  IF ( y .EQ. cl(0,0) ) cl4 = cl(1,0)
  DO i = 1,ns-1
     IF ( ( y .GT. cl(0,i-1) ) .AND. (y .LE. cl(0,i) ) ) THEN
        cl4 = cl(1,i-1) + (y - cl(0,i-1))*( ( cl(1,i) - cl(1,i-1) )/( cl(0,i) - cl(0,i-1) ) )
        GOTO 1
     ENDIF
  ENDDO

1 CONTINUE

   IF ( y .LT. cl(0,0) ) THEN 
     cl4 = cl(1,0)
!     PRINT*,'alpha < tabulated range in calc_cl4_nrel28.pro'
  ENDIF
  IF ( y .GT. cl(0,ns-1) ) THEN 
     cl4 = cl(1,ns-1) 
!     PRINT*,'alpha > tabulated range in calc_cl4_nrel28.pro'
  ENDIF
  
!PRINT*,y,cl4
  
 
!————————————————————————————————————
END FUNCTION calc_cl4_nrel28
!_________________________________________________________________________

!=========================================================================

FUNCTION calc_cl5_nrel28( y ) RESULT( cl5 )
!_________________________________________________________________________
!
! Data from DU97-W-300 airfoil
!_________________________________________________________________________
  
  REAL, INTENT( IN ) :: y

  REAL, PARAMETER :: ns = 145

  REAL, DIMENSION( 0:1,0:ns-1 ) :: cl

  REAL :: cl5
  INTEGER :: i

  cl5 = 0.0
  
!                alpha     CL    
  cl(0:1, 0) = [-179.96604345059157, 0.0]
  cl(0:1, 1) = [-174.99998905707469, 0.183011]
  cl(0:1, 2) = [-170.00001556208605, 0.366022]
  cl(0:1, 3) = [-164.99998477131788, 0.549033]
  cl(0:1, 4) = [-160.00001127632925, 0.732043]
  cl(0:1, 5) = [-154.99998048556108, 0.721204]
  cl(0:1, 6) = [-150.00000699057244, 0.710364]
  cl(0:1, 7) = [-144.9999761998043, 0.687747]
  cl(0:1, 8) = [-140.00000270481564, 0.665129]
  cl(0:1, 9) = [-134.99997191404748, 0.631517]
  cl(0:1, 10) = [-129.99999841905884, 0.597904]
  cl(0:1, 11) = [-125.00002492407022, 0.545144]
  cl(0:1, 12) = [-119.99999413330205, 0.492383]
  cl(0:1, 13) = [-115.0000206383134, 0.420844]
  cl(0:1, 14) = [-109.99998984754525, 0.349304]
  cl(0:1, 15) = [-105.0000163525566, 0.264378]
  cl(0:1, 16) = [-99.99998556178845, 0.179451]
  cl(0:1, 17) = [-95.00001206679983, 0.089726]
  cl(0:1, 18) = [-89.99998127603166, 0.0]
  cl(0:1, 19) = [-85.00000778104302, -0.089726]
  cl(0:1, 20) = [-79.99997699027486, -0.179451]
  cl(0:1, 21) = [-75.00000349528622, -0.264378]
  cl(0:1, 22) = [-69.99997270451807, -0.349304]
  cl(0:1, 23) = [-64.99999920952942, -0.420844]
  cl(0:1, 24) = [-60.00002571454079, -0.492383]
  cl(0:1, 25) = [-54.999994923772626, -0.545144]
  cl(0:1, 26) = [-50.00002142878399, -0.597904]
  cl(0:1, 27) = [-44.99999063801583, -0.635816]
  cl(0:1, 28) = [-40.000017143027186, -0.665129]
  cl(0:1, 29) = [-37.999993367564024, -0.674965]
  cl(0:1, 30) = [-36.00002688788037, -0.684059]
  cl(0:1, 31) = [-34.00000311241721, -0.692718]
  cl(0:1, 32) = [-31.999979336954045, -0.701325]
  cl(0:1, 33) = [-30.000012857270395, -0.710364]
  cl(0:1, 34) = [-27.99998908180723, -0.72045]
  cl(0:1, 35) = [-26.000022602123575, -0.732376]
  cl(0:1, 36) = [-23.99999882666041, -0.747179]
  cl(0:1, 37) = [-21.999975051197243, -0.766249]
  cl(0:1, 38) = [-20.000008571513593, -0.921528]
  cl(0:1, 39) = [-19.000025331671768, -0.999168]
  cl(0:1, 40) = [-17.99998479605043, -1.07681]
  cl(0:1, 41) = [-17.000001556208606, -1.15445]
  cl(0:1, 42) = [-16.000018316366777, -1.23209]
  cl(0:1, 43) = [-14.99997778074544, -1.25939]
  cl(0:1, 44) = [-13.999994540903614, -1.19356]
  cl(0:1, 45) = [-13.499974273092944, -1.15169]
  cl(0:1, 46) = [-13.000011301061788, -1.10982]
  cl(0:1, 47) = [-12.499991033251119, -1.06479]
  cl(0:1, 48) = [-12.000028061219961, -1.01976]
  cl(0:1, 49) = [-11.500007793409292, -0.975371]
  cl(0:1, 50) = [-10.999987525598621, -0.930981]
  cl(0:1, 51) = [-10.500024553567467, -0.884256]
  cl(0:1, 52) = [-10.000004285756797, -0.837531]
  cl(0:1, 53) = [-9.499984017946128, -0.801466]
  cl(0:1, 54) = [-9.000021045914972, -0.7654]
  cl(0:1, 55) = [-8.500000778104303, -0.7513]
  cl(0:1, 56) = [-7.999980510293632, -0.7372]
  cl(0:1, 57) = [-7.500017538262475, -0.693157]
  cl(0:1, 58) = [-6.999997270451807, -0.649113]
  cl(0:1, 59) = [-6.499977002641137, -0.578268]
  cl(0:1, 60) = [-6.0000140306099805, -0.507423]
  cl(0:1, 61) = [-5.499993762799311, -0.438193]
  cl(0:1, 62) = [-4.999973494988642, -0.368962]
  cl(0:1, 63) = [-4.500010522957486, -0.30101]
  cl(0:1, 64) = [-3.999990255146816, -0.233057]
  cl(0:1, 65) = [-3.50002728311566, -0.166547]
  cl(0:1, 66) = [-3.0000070153049903, -0.100554]
  cl(0:1, 67) = [-2.499986747494321, -0.036198]
  cl(0:1, 68) = [-2.0000237754631645, 0.028028]
  cl(0:1, 69) = [-1.5000035076524951, 0.091789]
  cl(0:1, 70) = [-0.9999832398418258, 0.155626]
  cl(0:1, 71) = [-0.5000202678106694, 0.221283]
  cl(0:1, 72) = [0.0, 0.28687]
  cl(0:1, 73) = [0.5000202678106694, 0.35137]
  cl(0:1, 74) = [0.9999832398418258, 0.415841]
  cl(0:1, 75) = [1.5000035076524951, 0.47986]
  cl(0:1, 76) = [2.0000237754631645, 0.543879]
  cl(0:1, 77) = [2.499986747494321, 0.605824]
  cl(0:1, 78) = [3.0000070153049903, 0.667588]
  cl(0:1, 79) = [3.50002728311566, 0.72928]
  cl(0:1, 80) = [3.999990255146816, 0.790963]
  cl(0:1, 81) = [4.500010522957486, 0.851899]
  cl(0:1, 82) = [4.999973494988642, 0.912835]
  cl(0:1, 83) = [5.499993762799311, 0.971833]
  cl(0:1, 84) = [6.0000140306099805, 1.03083]
  cl(0:1, 85) = [6.499977002641137, 1.08804]
  cl(0:1, 86) = [6.999997270451807, 1.14525]
  cl(0:1, 87) = [7.500017538262475, 1.2004]
  cl(0:1, 88) = [7.999980510293632, 1.25555]
  cl(0:1, 89) = [8.500000778104303, 1.3075]
  cl(0:1, 90) = [9.000021045914972, 1.35945]
  cl(0:1, 91) = [9.499984017946128, 1.40588]
  cl(0:1, 92) = [10.000004285756797, 1.45231]
  cl(0:1, 93) = [10.500024553567467, 1.48899]
  cl(0:1, 94) = [10.999987525598621, 1.52567]
  cl(0:1, 95) = [11.500007793409292, 1.54241]
  cl(0:1, 96) = [12.000028061219961, 1.55915]
  cl(0:1, 97) = [12.499991033251119, 1.37749]
  cl(0:1, 98) = [13.000011301061788, 1.19583]
  cl(0:1, 99) = [13.499974273092944, 1.148005]
  cl(0:1, 100) = [13.999994540903614, 1.10018]
  cl(0:1, 101) = [14.99997778074544, 1.04995]
  cl(0:1, 102) = [16.000018316366777, 1.02155]
  cl(0:1, 103) = [17.000001556208606, 1.00735]
  cl(0:1, 104) = [17.99998479605043, 1.0099]
  cl(0:1, 105) = [19.000025331671768, 1.0397]
  cl(0:1, 106) = [20.000008571513593, 1.06549]
  cl(0:1, 107) = [21.999975051197243, 1.09464]
  cl(0:1, 108) = [23.99999882666041, 1.0674]
  cl(0:1, 109) = [26.000022602123575, 1.04625]
  cl(0:1, 110) = [27.99998908180723, 1.02921]
  cl(0:1, 111) = [30.000012857270395, 1.01481]
  cl(0:1, 112) = [31.999979336954045, 1.00189]
  cl(0:1, 113) = [34.00000311241721, 0.989597]
  cl(0:1, 114) = [36.00002688788037, 0.977228]
  cl(0:1, 115) = [37.999993367564024, 0.964236]
  cl(0:1, 116) = [40.000017143027186, 0.950185]
  cl(0:1, 117) = [44.99999063801583, 0.908309]
  cl(0:1, 118) = [50.00002142878399, 0.854148]
  cl(0:1, 119) = [54.999994923772626, 0.778776]
  cl(0:1, 120) = [60.00002571454079, 0.703404]
  cl(0:1, 121) = [64.99999920952942, 0.601205]
  cl(0:1, 122) = [69.99997270451807, 0.499006]
  cl(0:1, 123) = [75.00000349528622, 0.377683]
  cl(0:1, 124) = [79.99997699027486, 0.256359]
  cl(0:1, 125) = [85.00000778104302, 0.12818]
  cl(0:1, 126) = [89.99998127603166, 0.0]
  cl(0:1, 127) = [95.00001206679983, -0.089726]
  cl(0:1, 128) = [99.99998556178845, -0.179451]
  cl(0:1, 129) = [105.0000163525566, -0.264378]
  cl(0:1, 130) = [109.99998984754525, -0.349304]
  cl(0:1, 131) = [115.0000206383134, -0.420844]
  cl(0:1, 132) = [119.99999413330205, -0.492383]
  cl(0:1, 133) = [125.00002492407022, -0.545144]
  cl(0:1, 134) = [129.99999841905884, -0.597904]
  cl(0:1, 135) = [134.99997191404748, -0.631517]
  cl(0:1, 136) = [140.00000270481564, -0.665129]
  cl(0:1, 137) = [144.9999761998043, -0.687747]
  cl(0:1, 138) = [150.00000699057244, -0.710364]
  cl(0:1, 139) = [154.99998048556108, -0.703477]
  cl(0:1, 140) = [160.00001127632925, -0.69659]
  cl(0:1, 141) = [164.99998477131788, -0.522443]
  cl(0:1, 142) = [170.00001556208605, -0.348295]
  cl(0:1, 143) = [174.99998905707469, -0.174148]
  cl(0:1, 144) = [179.96604345059157, 0.0]
  
  IF ( y .EQ. cl(0,0) ) cl5 = cl(1,0)
  DO i = 1,ns-1
     IF ( ( y .GT. cl(0,i-1) ) .AND. ( y .LE. cl(0,i) ) ) THEN
        cl5 = cl(1,i-1) + (y - cl(0,i-1))*( ( cl(1,i) - cl(1,i-1) )/( cl(0,i) - cl(0,i-1) ) )
        GOTO 1
     ENDIF
  ENDDO 

1 CONTINUE
  
  IF ( y .LT. cl(0,0) ) THEN
     cl5 = cl(1,0)
!     PRINT*,'alpha < tabulated range in calc_cl5_nrel28.pro'
  ENDIF
  IF ( y .GT. cl(0,ns-1) ) THEN
     cl5 = cl(1,ns-1) 
!     PRINT*,'alpha > tabulated range in calc_cl5_nrel28.pro'
  ENDIF
  
!PRINT*,y,cl5
  
!_________________________________________________________________________
  
END FUNCTION calc_cl5_nrel28
!_________________________________________________________________________


!=========================================================================

FUNCTION calc_cl6_nrel28( y ) RESULT( cl6 )
!_________________________________________________________________________
!
! Data from DU91-W2-250 airfoil
!_________________________________________________________________________
  
  REAL, INTENT( IN ) :: y

  REAL, PARAMETER :: ns = 145

  REAL, DIMENSION( 0:1,0:ns-1 ) :: cl

  REAL :: cl6
  INTEGER :: i

  cl6 = 0.0
  
!                alpha     CL    
  cl(0:1, 0) = [-179.96604345059157, 0.0]
  cl(0:1, 1) = [-174.99998905707469, 0.181476]
  cl(0:1, 2) = [-170.00001556208605, 0.362951]
  cl(0:1, 3) = [-164.99998477131788, 0.544427]
  cl(0:1, 4) = [-160.00001127632925, 0.725903]
  cl(0:1, 5) = [-154.99998048556108, 0.731252]
  cl(0:1, 6) = [-150.00000699057244, 0.736601]
  cl(0:1, 7) = [-144.9999761998043, 0.70885]
  cl(0:1, 8) = [-140.00000270481564, 0.681098]
  cl(0:1, 9) = [-134.99997191404748, 0.644218]
  cl(0:1, 10) = [-129.99999841905884, 0.607338]
  cl(0:1, 11) = [-125.00002492407022, 0.552385]
  cl(0:1, 12) = [-119.99999413330205, 0.497432]
  cl(0:1, 13) = [-115.0000206383134, 0.424457]
  cl(0:1, 14) = [-109.99998984754525, 0.351482]
  cl(0:1, 15) = [-105.0000163525566, 0.265735]
  cl(0:1, 16) = [-99.99998556178845, 0.179987]
  cl(0:1, 17) = [-95.00001206679983, 0.089994]
  cl(0:1, 18) = [-89.99998127603166, 0.0]
  cl(0:1, 19) = [-85.00000778104302, -0.089994]
  cl(0:1, 20) = [-79.99997699027486, -0.179987]
  cl(0:1, 21) = [-75.00000349528622, -0.265735]
  cl(0:1, 22) = [-69.99997270451807, -0.351482]
  cl(0:1, 23) = [-64.99999920952942, -0.424457]
  cl(0:1, 24) = [-60.00002571454079, -0.497432]
  cl(0:1, 25) = [-54.999994923772626, -0.552385]
  cl(0:1, 26) = [-50.00002142878399, -0.607338]
  cl(0:1, 27) = [-44.99999063801583, -0.648184]
  cl(0:1, 28) = [-40.000017143027186, -0.681098]
  cl(0:1, 29) = [-37.999993367564024, -0.692607]
  cl(0:1, 30) = [-36.00002688788037, -0.703536]
  cl(0:1, 31) = [-34.00000311241721, -0.714216]
  cl(0:1, 32) = [-31.999979336954045, -0.725063]
  cl(0:1, 33) = [-30.000012857270395, -0.736601]
  cl(0:1, 34) = [-27.99998908180723, -0.749496]
  cl(0:1, 35) = [-26.000022602123575, -0.764609]
  cl(0:1, 36) = [-23.99999882666041, -0.783068]
  cl(0:1, 37) = [-21.999975051197243, -0.811814]
  cl(0:1, 38) = [-20.000008571513593, -0.847429]
  cl(0:1, 39) = [-19.000025331671768, -0.865237]
  cl(0:1, 40) = [-17.99998479605043, -0.883045]
  cl(0:1, 41) = [-17.000001556208606, -0.900852]
  cl(0:1, 42) = [-16.000018316366777, -0.91866]
  cl(0:1, 43) = [-14.99997778074544, -0.936467]
  cl(0:1, 44) = [-13.999994540903614, -0.954275]
  cl(0:1, 45) = [-13.499974273092944, -0.963179]
  cl(0:1, 46) = [-13.000011301061788, -0.972082]
  cl(0:1, 47) = [-12.499991033251119, -0.960781]
  cl(0:1, 48) = [-12.000028061219961, -0.94948]
  cl(0:1, 49) = [-11.500007793409292, -0.92624]
  cl(0:1, 50) = [-10.999987525598621, -0.903]
  cl(0:1, 51) = [-10.500024553567467, -0.871118]
  cl(0:1, 52) = [-10.000004285756797, -0.839235]
  cl(0:1, 53) = [-9.499984017946128, -0.806038]
  cl(0:1, 54) = [-9.000021045914972, -0.77284]
  cl(0:1, 55) = [-8.500000778104303, -0.717489]
  cl(0:1, 56) = [-7.999980510293632, -0.662137]
  cl(0:1, 57) = [-7.500017538262475, -0.594918]
  cl(0:1, 58) = [-6.999997270451807, -0.527699]
  cl(0:1, 59) = [-6.499977002641137, -0.457428]
  cl(0:1, 60) = [-6.0000140306099805, -0.387157]
  cl(0:1, 61) = [-5.499993762799311, -0.317098]
  cl(0:1, 62) = [-4.999973494988642, -0.247038]
  cl(0:1, 63) = [-4.500010522957486, -0.178731]
  cl(0:1, 64) = [-3.999990255146816, -0.110423]
  cl(0:1, 65) = [-3.50002728311566, -0.04392]
  cl(0:1, 66) = [-3.0000070153049903, 0.022845]
  cl(0:1, 67) = [-2.499986747494321, 0.088864]
  cl(0:1, 68) = [-2.0000237754631645, 0.154621]
  cl(0:1, 69) = [-1.5000035076524951, 0.219184]
  cl(0:1, 70) = [-0.9999832398418258, 0.283456]
  cl(0:1, 71) = [-0.5000202678106694, 0.345592]
  cl(0:1, 72) = [0.0, 0.40775]
  cl(0:1, 73) = [0.5000202678106694, 0.470252]
  cl(0:1, 74) = [0.9999832398418258, 0.532874]
  cl(0:1, 75) = [1.5000035076524951, 0.595495]
  cl(0:1, 76) = [2.0000237754631645, 0.658]
  cl(0:1, 77) = [2.499986747494321, 0.7205]
  cl(0:1, 78) = [3.0000070153049903, 0.781825]
  cl(0:1, 79) = [3.50002728311566, 0.84299]
  cl(0:1, 80) = [3.999990255146816, 0.903757]
  cl(0:1, 81) = [4.500010522957486, 0.964104]
  cl(0:1, 82) = [4.999973494988642, 1.02445]
  cl(0:1, 83) = [5.499993762799311, 1.0828]
  cl(0:1, 84) = [6.0000140306099805, 1.14115]
  cl(0:1, 85) = [6.499977002641137, 1.19476]
  cl(0:1, 86) = [6.999997270451807, 1.24837]
  cl(0:1, 87) = [7.500017538262475, 1.28898]
  cl(0:1, 88) = [7.999980510293632, 1.32959]
  cl(0:1, 89) = [8.500000778104303, 1.34749]
  cl(0:1, 90) = [9.000021045914972, 1.36539]
  cl(0:1, 91) = [9.499984017946128, 1.335805]
  cl(0:1, 92) = [10.000004285756797, 1.30622]
  cl(0:1, 93) = [10.500024553567467, 1.231305]
  cl(0:1, 94) = [10.999987525598621, 1.15639]
  cl(0:1, 95) = [11.500007793409292, 1.13253]
  cl(0:1, 96) = [12.000028061219961, 1.10867]
  cl(0:1, 97) = [12.499991033251119, 1.102675]
  cl(0:1, 98) = [13.000011301061788, 1.09668]
  cl(0:1, 99) = [13.499974273092944, 1.10443]
  cl(0:1, 100) = [13.999994540903614, 1.11218]
  cl(0:1, 101) = [14.99997778074544, 1.12574]
  cl(0:1, 102) = [16.000018316366777, 1.12882]
  cl(0:1, 103) = [17.000001556208606, 1.12162]
  cl(0:1, 104) = [17.99998479605043, 1.12738]
  cl(0:1, 105) = [19.000025331671768, 1.13392]
  cl(0:1, 106) = [20.000008571513593, 1.1391]
  cl(0:1, 107) = [21.999975051197243, 1.14722]
  cl(0:1, 108) = [23.99999882666041, 1.11867]
  cl(0:1, 109) = [26.000022602123575, 1.0923]
  cl(0:1, 110) = [27.99998908180723, 1.07071]
  cl(0:1, 111) = [30.000012857270395, 1.05229]
  cl(0:1, 112) = [31.999979336954045, 1.0358]
  cl(0:1, 113) = [34.00000311241721, 1.02031]
  cl(0:1, 114) = [36.00002688788037, 1.00505]
  cl(0:1, 115) = [37.999993367564024, 0.989439]
  cl(0:1, 116) = [40.000017143027186, 0.972997]
  cl(0:1, 117) = [44.99999063801583, 0.925978]
  cl(0:1, 118) = [50.00002142878399, 0.867626]
  cl(0:1, 119) = [54.999994923772626, 0.789122]
  cl(0:1, 120) = [60.00002571454079, 0.710617]
  cl(0:1, 121) = [64.99999920952942, 0.606367]
  cl(0:1, 122) = [69.99997270451807, 0.502117]
  cl(0:1, 123) = [75.00000349528622, 0.379621]
  cl(0:1, 124) = [79.99997699027486, 0.257124]
  cl(0:1, 125) = [85.00000778104302, 0.128562]
  cl(0:1, 126) = [89.99998127603166, 0.0]
  cl(0:1, 127) = [95.00001206679983, -0.089994]
  cl(0:1, 128) = [99.99998556178845, -0.179987]
  cl(0:1, 129) = [105.0000163525566, -0.265735]
  cl(0:1, 130) = [109.99998984754525, -0.351482]
  cl(0:1, 131) = [115.0000206383134, -0.424457]
  cl(0:1, 132) = [119.99999413330205, -0.497432]
  cl(0:1, 133) = [125.00002492407022, -0.552385]
  cl(0:1, 134) = [129.99999841905884, -0.607338]
  cl(0:1, 135) = [134.99997191404748, -0.644218]
  cl(0:1, 136) = [140.00000270481564, -0.681098]
  cl(0:1, 137) = [144.9999761998043, -0.70885]
  cl(0:1, 138) = [150.00000699057244, -0.736601]
  cl(0:1, 139) = [154.99998048556108, -0.713521]
  cl(0:1, 140) = [160.00001127632925, -0.690441]
  cl(0:1, 141) = [164.99998477131788, -0.517831]
  cl(0:1, 142) = [170.00001556208605, -0.34522]
  cl(0:1, 143) = [174.99998905707469, -0.17261]
  cl(0:1, 144) = [179.96604345059157, 0.0]
  
  IF ( y .EQ. cl(0,0) ) cl6 = cl(1,0)
  DO i = 1,ns-1
     IF ( ( y .GT. cl(0,i-1) ) .AND. (y .LE. cl(0,i) ) ) THEN
        cl6 = cl(1,i-1) + (y - cl(0,i-1))*( ( cl(1,i) - cl(1,i-1) )/( cl(0,i) - cl(0,i-1) ) )
        GOTO 1
     ENDIF
  ENDDO

1 CONTINUE
  
  IF ( y .LT. cl(0,0) ) THEN
     cl6 = cl(1,0)
!     PRINT*,'alpha < tabulated range in calc_cl6_nrel28.pro'
  ENDIF
  IF ( y .GT. cl(0,ns-1) ) THEN
     cl6 = cl(1,ns-1) 
!     PRINT*,'alpha > tabulated range in calc_cl6_nrel28.pro'
  ENDIF
  
!PRINT*,y,cl6
  
!_________________________________________________________________________
  
END FUNCTION calc_cl6_nrel28
!_________________________________________________________________________


!=========================================================================

FUNCTION calc_cl7_nrel28( y ) RESULT( cl7 )
!_________________________________________________________________________
!
! Data from DU08-W-210 airfoil
!_________________________________________________________________________
  
  REAL, INTENT( IN ) :: y

  REAL, PARAMETER :: ns = 145

  REAL, DIMENSION( 0:1,0:ns-1 ) :: cl

  REAL :: cl7
  INTEGER :: i

  cl7 = 0.0
  
!                alpha     CL    
  cl(0:1, 0) = [-179.96604345059157, 0.0]
  cl(0:1, 1) = [-174.99998905707469, 0.250261]
  cl(0:1, 2) = [-170.00001556208605, 0.500522]
  cl(0:1, 3) = [-164.99998477131788, 0.65457]
  cl(0:1, 4) = [-160.00001127632925, 0.808618]
  cl(0:1, 5) = [-154.99998048556108, 0.764463]
  cl(0:1, 6) = [-150.00000699057244, 0.720308]
  cl(0:1, 7) = [-144.9999761998043, 0.695745]
  cl(0:1, 8) = [-140.00000270481564, 0.671182]
  cl(0:1, 9) = [-134.99997191404748, 0.636331]
  cl(0:1, 10) = [-129.99999841905884, 0.60148]
  cl(0:1, 11) = [-125.00002492407022, 0.547889]
  cl(0:1, 12) = [-119.99999413330205, 0.494297]
  cl(0:1, 13) = [-115.0000206383134, 0.422213]
  cl(0:1, 14) = [-109.99998984754525, 0.350129]
  cl(0:1, 15) = [-105.0000163525566, 0.264892]
  cl(0:1, 16) = [-99.99998556178845, 0.179654]
  cl(0:1, 17) = [-95.00001206679983, 0.089827]
  cl(0:1, 18) = [-89.99998127603166, 0.0]
  cl(0:1, 19) = [-85.00000778104302, -0.089827]
  cl(0:1, 20) = [-79.99997699027486, -0.179654]
  cl(0:1, 21) = [-75.00000349528622, -0.264892]
  cl(0:1, 22) = [-69.99997270451807, -0.350129]
  cl(0:1, 23) = [-64.99999920952942, -0.422213]
  cl(0:1, 24) = [-60.00002571454079, -0.494297]
  cl(0:1, 25) = [-54.999994923772626, -0.547889]
  cl(0:1, 26) = [-50.00002142878399, -0.60148]
  cl(0:1, 27) = [-44.99999063801583, -0.640504]
  cl(0:1, 28) = [-40.000017143027186, -0.671182]
  cl(0:1, 29) = [-37.999993367564024, -0.681652]
  cl(0:1, 30) = [-36.00002688788037, -0.691442]
  cl(0:1, 31) = [-34.00000311241721, -0.700866]
  cl(0:1, 32) = [-31.999979336954045, -0.710322]
  cl(0:1, 33) = [-30.000012857270395, -0.720308]
  cl(0:1, 34) = [-27.99998908180723, -0.731459]
  cl(0:1, 35) = [-26.000022602123575, -0.744593]
  cl(0:1, 36) = [-23.99999882666041, -0.760782]
  cl(0:1, 37) = [-21.999975051197243, -0.781463]
  cl(0:1, 38) = [-20.000008571513593, -0.808618]
  cl(0:1, 39) = [-19.000025331671768, -0.825459]
  cl(0:1, 40) = [-17.99998479605043, -0.82]
  cl(0:1, 41) = [-17.000001556208606, -0.813739]
  cl(0:1, 42) = [-16.000018316366777, -0.782412]
  cl(0:1, 43) = [-14.99997778074544, -0.751085]
  cl(0:1, 44) = [-13.999994540903614, -0.719757]
  cl(0:1, 45) = [-13.499974273092944, -0.704094]
  cl(0:1, 46) = [-13.000011301061788, -0.68843]
  cl(0:1, 47) = [-12.499991033251119, -0.672767]
  cl(0:1, 48) = [-12.000028061219961, -0.657103]
  cl(0:1, 49) = [-11.500007793409292, -0.64144]
  cl(0:1, 50) = [-10.999987525598621, -0.625776]
  cl(0:1, 51) = [-10.500024553567467, -0.610113]
  cl(0:1, 52) = [-10.000004285756797, -0.594449]
  cl(0:1, 53) = [-9.499984017946128, -0.578786]
  cl(0:1, 54) = [-9.000021045914972, -0.563122]
  cl(0:1, 55) = [-8.500000778104303, -0.535502]
  cl(0:1, 56) = [-7.999980510293632, -0.507882]
  cl(0:1, 57) = [-7.500017538262475, -0.437324]
  cl(0:1, 58) = [-6.999997270451807, -0.3661]
  cl(0:1, 59) = [-6.499977002641137, -0.3035]
  cl(0:1, 60) = [-6.0000140306099805, -0.2415]
  cl(0:1, 61) = [-5.499993762799311, -0.18]
  cl(0:1, 62) = [-4.999973494988642, -0.1187]
  cl(0:1, 63) = [-4.500010522957486, -0.0577]
  cl(0:1, 64) = [-3.999990255146816, 0.003]
  cl(0:1, 65) = [-3.50002728311566, 0.0635]
  cl(0:1, 66) = [-3.0000070153049903, 0.1242]
  cl(0:1, 67) = [-2.499986747494321, 0.1846]
  cl(0:1, 68) = [-2.0000237754631645, 0.2447]
  cl(0:1, 69) = [-1.5000035076524951, 0.3051]
  cl(0:1, 70) = [-0.9999832398418258, 0.3651]
  cl(0:1, 71) = [-0.5000202678106694, 0.4251]
  cl(0:1, 72) = [0.0, 0.4848]
  cl(0:1, 73) = [0.5000202678106694, 0.5448]
  cl(0:1, 74) = [0.9999832398418258, 0.6043]
  cl(0:1, 75) = [1.5000035076524951, 0.6637]
  cl(0:1, 76) = [2.0000237754631645, 0.7231]
  cl(0:1, 77) = [2.499986747494321, 0.7823]
  cl(0:1, 78) = [3.0000070153049903, 0.841]
  cl(0:1, 79) = [3.50002728311566, 0.9001]
  cl(0:1, 80) = [3.999990255146816, 0.9585]
  cl(0:1, 81) = [4.500010522957486, 1.0166]
  cl(0:1, 82) = [4.999973494988642, 1.0745]
  cl(0:1, 83) = [5.499993762799311, 1.1319]
  cl(0:1, 84) = [6.0000140306099805, 1.188]
  cl(0:1, 85) = [6.499977002641137, 1.2419]
  cl(0:1, 86) = [6.999997270451807, 1.291]
  cl(0:1, 87) = [7.500017538262475, 1.3334]
  cl(0:1, 88) = [7.999980510293632, 1.3725]
  cl(0:1, 89) = [8.500000778104303, 1.4118]
  cl(0:1, 90) = [9.000021045914972, 1.4511]
  cl(0:1, 91) = [9.499984017946128, 1.4887]
  cl(0:1, 92) = [10.000004285756797, 1.5162]
  cl(0:1, 93) = [10.500024553567467, 1.5422]
  cl(0:1, 94) = [10.999987525598621, 1.5626]
  cl(0:1, 95) = [11.500007793409292, 1.5804]
  cl(0:1, 96) = [12.000028061219961, 1.5871]
  cl(0:1, 97) = [12.499991033251119, 1.54855]
  cl(0:1, 98) = [13.000011301061788, 1.51]
  cl(0:1, 99) = [13.499974273092944, 1.46]
  cl(0:1, 100) = [13.999994540903614, 1.41]
  cl(0:1, 101) = [14.99997778074544, 1.34]
  cl(0:1, 102) = [16.000018316366777, 1.3]
  cl(0:1, 103) = [17.000001556208606, 1.26]
  cl(0:1, 104) = [17.99998479605043, 1.2]
  cl(0:1, 105) = [19.000025331671768, 1.17923]
  cl(0:1, 106) = [20.000008571513593, 1.15517]
  cl(0:1, 107) = [21.999975051197243, 1.11638]
  cl(0:1, 108) = [23.99999882666041, 1.08683]
  cl(0:1, 109) = [26.000022602123575, 1.0637]
  cl(0:1, 110) = [27.99998908180723, 1.04494]
  cl(0:1, 111) = [30.000012857270395, 1.02901]
  cl(0:1, 112) = [31.999979336954045, 1.01475]
  cl(0:1, 113) = [34.00000311241721, 1.00124]
  cl(0:1, 114) = [36.00002688788037, 0.987774]
  cl(0:1, 115) = [37.999993367564024, 0.973789]
  cl(0:1, 116) = [40.000017143027186, 0.958831]
  cl(0:1, 117) = [44.99999063801583, 0.915006]
  cl(0:1, 118) = [50.00002142878399, 0.859257]
  cl(0:1, 119) = [54.999994923772626, 0.782698]
  cl(0:1, 120) = [60.00002571454079, 0.706138]
  cl(0:1, 121) = [64.99999920952942, 0.603162]
  cl(0:1, 122) = [69.99997270451807, 0.500185]
  cl(0:1, 123) = [75.00000349528622, 0.378417]
  cl(0:1, 124) = [79.99997699027486, 0.256649]
  cl(0:1, 125) = [85.00000778104302, 0.128325]
  cl(0:1, 126) = [89.99998127603166, 0.0]
  cl(0:1, 127) = [95.00001206679983, -0.089827]
  cl(0:1, 128) = [99.99998556178845, -0.179654]
  cl(0:1, 129) = [105.0000163525566, -0.264892]
  cl(0:1, 130) = [109.99998984754525, -0.350129]
  cl(0:1, 131) = [115.0000206383134, -0.422213]
  cl(0:1, 132) = [119.99999413330205, -0.494297]
  cl(0:1, 133) = [125.00002492407022, -0.547889]
  cl(0:1, 134) = [129.99999841905884, -0.60148]
  cl(0:1, 135) = [134.99997191404748, -0.636331]
  cl(0:1, 136) = [140.00000270481564, -0.671182]
  cl(0:1, 137) = [144.9999761998043, -0.695745]
  cl(0:1, 138) = [150.00000699057244, -0.720308]
  cl(0:1, 139) = [154.99998048556108, -0.764463]
  cl(0:1, 140) = [160.00001127632925, -0.808618]
  cl(0:1, 141) = [164.99998477131788, -0.63905]
  cl(0:1, 142) = [170.00001556208605, -0.469481]
  cl(0:1, 143) = [174.99998905707469, -0.234741]
  cl(0:1, 144) = [179.96604345059157, 0.0]
  
  IF ( y .EQ. cl(0,0) ) cl7 = cl(1,0)
  DO i = 1,ns-1
     IF ( ( y .GT. cl(0,i-1) ) .AND. (y .LE. cl(0,i) ) ) THEN
        cl7 = cl(1,i-1) + (y - cl(0,i-1))*( ( cl(1,i) - cl(1,i-1) )/( cl(0,i) - cl(0,i-1) ) )
        GOTO 1
     ENDIF
  ENDDO

1 CONTINUE
  
  IF ( y .LT. cl(0,0) ) THEN
     cl7 = cl(1,0)
!     PRINT*,'alpha < tabulated range in calc_cl7_nrel28.pro'
  ENDIF
  IF ( y .GT. cl(0,ns-1) ) THEN
     cl7 = cl(1,ns-1) 
!     PRINT*,'alpha > tabulated range in calc_cl7_nrel28.pro'
  ENDIF

!PRINT*,y,cl7
  
!_________________________________________________________________________
  
END FUNCTION calc_cl7_nrel28
!_________________________________________________________________________



!=========================================================================


!_________________________________________________________________________


!=========================================================================

FUNCTION calc_cd1_nrel28( y ) RESULT( cd1 )
!_________________________________________________________________________
!
! Data from cylinder
!_________________________________________________________________________
  
  REAL, INTENT( IN ) :: y

  REAL :: cd1

  cd1 = 0.5
  
!_________________________________________________________________________
  
END FUNCTION calc_cd1_nrel28
!_________________________________________________________________________

!=========================================================================

FUNCTION calc_cd2_nrel28( y ) RESULT( cd2 )
!_________________________________________________________________________
!
!  Data from FX77-W-500
!_________________________________________________________________________

  REAL, INTENT( IN ) :: y

  REAL, PARAMETER :: ns = 145

  REAL, DIMENSION( 0:1,0:ns-1 ) :: cd

  REAL :: cd2
  INTEGER :: i

  cd2 = 0.0
  
!                alpha    CD   
  cd(0:1, 0) = [-179.96604345059157, 0.1546]
  cd(0:1, 1) = [-174.99998905707469, 0.17285]
  cd(0:1, 2) = [-170.00001556208605, 0.1911]
  cd(0:1, 3) = [-164.99998477131788, 0.24365]
  cd(0:1, 4) = [-160.00001127632925, 0.2962]
  cd(0:1, 5) = [-154.99998048556108, 0.3763]
  cd(0:1, 6) = [-150.00000699057244, 0.4564]
  cd(0:1, 7) = [-144.9999761998043, 0.5539]
  cd(0:1, 8) = [-140.00000270481564, 0.6514]
  cd(0:1, 9) = [-134.99997191404748, 0.7539]
  cd(0:1, 10) = [-129.99999841905884, 0.8564]
  cd(0:1, 11) = [-125.00002492407022, 0.9506]
  cd(0:1, 12) = [-119.99999413330205, 1.0448]
  cd(0:1, 13) = [-115.0000206383134, 1.1184]
  cd(0:1, 14) = [-109.99998984754525, 1.192]
  cd(0:1, 15) = [-105.0000163525566, 1.23495]
  cd(0:1, 16) = [-99.99998556178845, 1.2779]
  cd(0:1, 17) = [-95.00001206679983, 1.28395]
  cd(0:1, 18) = [-89.99998127603166, 1.29]
  cd(0:1, 19) = [-85.00000778104302, 1.28395]
  cd(0:1, 20) = [-79.99997699027486, 1.2779]
  cd(0:1, 21) = [-75.00000349528622, 1.23495]
  cd(0:1, 22) = [-69.99997270451807, 1.192]
  cd(0:1, 23) = [-64.99999920952942, 1.1184]
  cd(0:1, 24) = [-60.00002571454079, 1.0448]
  cd(0:1, 25) = [-54.999994923772626, 0.9506]
  cd(0:1, 26) = [-50.00002142878399, 0.8564]
  cd(0:1, 27) = [-44.99999063801583, 0.7539]
  cd(0:1, 28) = [-40.000017143027186, 0.6514]
  cd(0:1, 29) = [-37.999993367564024, 0.6124]
  cd(0:1, 30) = [-36.00002688788037, 0.5734]
  cd(0:1, 31) = [-34.00000311241721, 0.5344]
  cd(0:1, 32) = [-31.999979336954045, 0.4954]
  cd(0:1, 33) = [-30.000012857270395, 0.4564]
  cd(0:1, 34) = [-27.99998908180723, 0.42436]
  cd(0:1, 35) = [-26.000022602123575, 0.39232]
  cd(0:1, 36) = [-23.99999882666041, 0.36028]
  cd(0:1, 37) = [-21.999975051197243, 0.32824]
  cd(0:1, 38) = [-20.000008571513593, 0.2962]
  cd(0:1, 39) = [-19.000025331671768, 0.28357]
  cd(0:1, 40) = [-17.99998479605043, 0.27094]
  cd(0:1, 41) = [-17.000001556208606, 0.25831]
  cd(0:1, 42) = [-16.000018316366777, 0.24568]
  cd(0:1, 43) = [-14.99997778074544, 0.23305]
  cd(0:1, 44) = [-13.999994540903614, 0.22042]
  cd(0:1, 45) = [-13.499974273092944, 0.21411]
  cd(0:1, 46) = [-13.000011301061788, 0.20779]
  cd(0:1, 47) = [-12.499991033251119, 0.20148]
  cd(0:1, 48) = [-12.000028061219961, 0.19516]
  cd(0:1, 49) = [-11.500007793409292, 0.18885]
  cd(0:1, 50) = [-10.999987525598621, 0.18253]
  cd(0:1, 51) = [-10.500024553567467, 0.17622]
  cd(0:1, 52) = [-10.000004285756797, 0.1699]
  cd(0:1, 53) = [-9.499984017946128, 0.16352]
  cd(0:1, 54) = [-9.000021045914972, 0.15714]
  cd(0:1, 55) = [-8.500000778104303, 0.15075]
  cd(0:1, 56) = [-7.999980510293632, 0.14437]
  cd(0:1, 57) = [-7.500017538262475, 0.13799]
  cd(0:1, 58) = [-6.999997270451807, 0.13161]
  cd(0:1, 59) = [-6.499977002641137, 0.12522]
  cd(0:1, 60) = [-6.0000140306099805, 0.11884]
  cd(0:1, 61) = [-5.499993762799311, 0.11246]
  cd(0:1, 62) = [-4.999973494988642, 0.10608]
  cd(0:1, 63) = [-4.500010522957486, 0.09969]
  cd(0:1, 64) = [-3.999990255146816, 0.09331]
  cd(0:1, 65) = [-3.50002728311566, 0.08693]
  cd(0:1, 66) = [-3.0000070153049903, 0.0833]
  cd(0:1, 67) = [-2.499986747494321, 0.08379]
  cd(0:1, 68) = [-2.0000237754631645, 0.08428]
  cd(0:1, 69) = [-1.5000035076524951, 0.08477]
  cd(0:1, 70) = [-0.9999832398418258, 0.08526]
  cd(0:1, 71) = [-0.5000202678106694, 0.08574]
  cd(0:1, 72) = [0.0, 0.08623]
  cd(0:1, 73) = [0.5000202678106694, 0.08672]
  cd(0:1, 74) = [0.9999832398418258, 0.08721]
  cd(0:1, 75) = [1.5000035076524951, 0.0877]
  cd(0:1, 76) = [2.0000237754631645, 0.08779]
  cd(0:1, 77) = [2.499986747494321, 0.08761]
  cd(0:1, 78) = [3.0000070153049903, 0.08743]
  cd(0:1, 79) = [3.50002728311566, 0.08725]
  cd(0:1, 80) = [3.999990255146816, 0.08707]
  cd(0:1, 81) = [4.500010522957486, 0.08689]
  cd(0:1, 82) = [4.999973494988642, 0.08672]
  cd(0:1, 83) = [5.499993762799311, 0.08654]
  cd(0:1, 84) = [6.0000140306099805, 0.08637]
  cd(0:1, 85) = [6.499977002641137, 0.08621]
  cd(0:1, 86) = [6.999997270451807, 0.08605]
  cd(0:1, 87) = [7.500017538262475, 0.08589]
  cd(0:1, 88) = [7.999980510293632, 0.08573]
  cd(0:1, 89) = [8.500000778104303, 0.08556]
  cd(0:1, 90) = [9.000021045914972, 0.08625]
  cd(0:1, 91) = [9.499984017946128, 0.0875]
  cd(0:1, 92) = [10.000004285756797, 0.08875]
  cd(0:1, 93) = [10.500024553567467, 0.1054]
  cd(0:1, 94) = [10.999987525598621, 0.1256]
  cd(0:1, 95) = [11.500007793409292, 0.141]
  cd(0:1, 96) = [12.000028061219961, 0.15542]
  cd(0:1, 97) = [12.499991033251119, 0.16922]
  cd(0:1, 98) = [13.000011301061788, 0.1825]
  cd(0:1, 99) = [13.499974273092944, 0.195]
  cd(0:1, 100) = [13.999994540903614, 0.2064]
  cd(0:1, 101) = [14.99997778074544, 0.22748]
  cd(0:1, 102) = [16.000018316366777, 0.24586]
  cd(0:1, 103) = [17.000001556208606, 0.25889]
  cd(0:1, 104) = [17.99998479605043, 0.27133]
  cd(0:1, 105) = [19.000025331671768, 0.28376]
  cd(0:1, 106) = [20.000008571513593, 0.2962]
  cd(0:1, 107) = [21.999975051197243, 0.32824]
  cd(0:1, 108) = [23.99999882666041, 0.36028]
  cd(0:1, 109) = [26.000022602123575, 0.39232]
  cd(0:1, 110) = [27.99998908180723, 0.42436]
  cd(0:1, 111) = [30.000012857270395, 0.4564]
  cd(0:1, 112) = [31.999979336954045, 0.4954]
  cd(0:1, 113) = [34.00000311241721, 0.5344]
  cd(0:1, 114) = [36.00002688788037, 0.5734]
  cd(0:1, 115) = [37.999993367564024, 0.6124]
  cd(0:1, 116) = [40.000017143027186, 0.6514]
  cd(0:1, 117) = [44.99999063801583, 0.7539]
  cd(0:1, 118) = [50.00002142878399, 0.8564]
  cd(0:1, 119) = [54.999994923772626, 0.9506]
  cd(0:1, 120) = [60.00002571454079, 1.0448]
  cd(0:1, 121) = [64.99999920952942, 1.1184]
  cd(0:1, 122) = [69.99997270451807, 1.192]
  cd(0:1, 123) = [75.00000349528622, 1.23495]
  cd(0:1, 124) = [79.99997699027486, 1.2779]
  cd(0:1, 125) = [85.00000778104302, 1.28395]
  cd(0:1, 126) = [89.99998127603166, 1.29]
  cd(0:1, 127) = [95.00001206679983, 1.28395]
  cd(0:1, 128) = [99.99998556178845, 1.2779]
  cd(0:1, 129) = [105.0000163525566, 1.23495]
  cd(0:1, 130) = [109.99998984754525, 1.192]
  cd(0:1, 131) = [115.0000206383134, 1.1184]
  cd(0:1, 132) = [119.99999413330205, 1.0448]
  cd(0:1, 133) = [125.00002492407022, 0.9506]
  cd(0:1, 134) = [129.99999841905884, 0.8564]
  cd(0:1, 135) = [134.99997191404748, 0.7539]
  cd(0:1, 136) = [140.00000270481564, 0.6514]
  cd(0:1, 137) = [144.9999761998043, 0.5539]
  cd(0:1, 138) = [150.00000699057244, 0.4564]
  cd(0:1, 139) = [154.99998048556108, 0.3763]
  cd(0:1, 140) = [160.00001127632925, 0.2962]
  cd(0:1, 141) = [164.99998477131788, 0.24365]
  cd(0:1, 142) = [170.00001556208605, 0.1911]
  cd(0:1, 143) = [174.99998905707469, 0.17285]
  cd(0:1, 144) = [179.96604345059157, 0.1546]
  
  IF ( y .EQ. cd(0,0) ) cd2 = cd(1,0)
  DO i = 1,ns-1 
     IF ( ( y .GT. cd(0,i-1) ) .AND. (y .LE. cd(0,i) ) ) THEN
        cd2 = cd(1,i-1) + (y - cd(0,i-1))*( ( cd(1,i) - cd(1,i-1) )/( cd(0,i) - cd(0,i-1) ) )
        GOTO 1
     ENDIF
  ENDDO 
1 CONTINUE
  
  IF ( y .LT. cd(0,0) ) THEN 
     cd2 = cd(1,0)
!     PRINT*,'alpha < tabulated range in calc_cd2_nrel28.pro'
  ENDIF
  IF ( y .GT. cd(0,ns-1) ) THEN 
     cd2 = cd(1,ns-1)
!     PRINT*,'alpha > tabulated range in calc_cd2_nrel28.pro'
  ENDIF
!_________________________________________________________________________
  
END FUNCTION calc_cd2_nrel28
!_________________________________________________________________________


!=========================================================================

FUNCTION calc_cd3_nrel28( y ) RESULT( cd3 )
!_________________________________________________________________________
!
! Data from FX77-W-400
!_________________________________________________________________________
  
  REAL, INTENT( IN ) :: y

  REAL, PARAMETER :: ns = 145

  REAL, DIMENSION( 0:1,0:ns-1 ) :: cd

  REAL :: cd3
  INTEGER :: i

  cd3 = 0.0
  
!                alpha    CD   
  cd(0:1, 0) = [-179.96604345059157, 0.01]
  cd(0:1, 1) = [-174.99998905707469, 0.01]
  cd(0:1, 2) = [-170.00001556208605, 0.01]
  cd(0:1, 3) = [-164.99998477131788, 0.0521]
  cd(0:1, 4) = [-160.00001127632925, 0.0942]
  cd(0:1, 5) = [-154.99998048556108, 0.1822]
  cd(0:1, 6) = [-150.00000699057244, 0.2702]
  cd(0:1, 7) = [-144.9999761998043, 0.3785]
  cd(0:1, 8) = [-140.00000270481564, 0.4868]
  cd(0:1, 9) = [-134.99997191404748, 0.6025]
  cd(0:1, 10) = [-129.99999841905884, 0.7182]
  cd(0:1, 11) = [-125.00002492407022, 0.82775]
  cd(0:1, 12) = [-119.99999413330205, 0.9373]
  cd(0:1, 13) = [-115.0000206383134, 1.0279]
  cd(0:1, 14) = [-109.99998984754525, 1.1185]
  cd(0:1, 15) = [-105.0000163525566, 1.17955]
  cd(0:1, 16) = [-99.99998556178845, 1.2406]
  cd(0:1, 17) = [-95.00001206679983, 1.2653]
  cd(0:1, 18) = [-89.99998127603166, 1.29]
  cd(0:1, 19) = [-85.00000778104302, 1.2653]
  cd(0:1, 20) = [-79.99997699027486, 1.2406]
  cd(0:1, 21) = [-75.00000349528622, 1.17955]
  cd(0:1, 22) = [-69.99997270451807, 1.1185]
  cd(0:1, 23) = [-64.99999920952942, 1.0279]
  cd(0:1, 24) = [-60.00002571454079, 0.9373]
  cd(0:1, 25) = [-54.999994923772626, 0.82775]
  cd(0:1, 26) = [-50.00002142878399, 0.7182]
  cd(0:1, 27) = [-44.99999063801583, 0.6025]
  cd(0:1, 28) = [-40.000017143027186, 0.4868]
  cd(0:1, 29) = [-37.999993367564024, 0.44348]
  cd(0:1, 30) = [-36.00002688788037, 0.40016]
  cd(0:1, 31) = [-34.00000311241721, 0.35684]
  cd(0:1, 32) = [-31.999979336954045, 0.31352]
  cd(0:1, 33) = [-30.000012857270395, 0.2702]
  cd(0:1, 34) = [-27.99998908180723, 0.235]
  cd(0:1, 35) = [-26.000022602123575, 0.1998]
  cd(0:1, 36) = [-23.99999882666041, 0.1646]
  cd(0:1, 37) = [-21.999975051197243, 0.1294]
  cd(0:1, 38) = [-20.000008571513593, 0.0942]
  cd(0:1, 39) = [-19.000025331671768, 0.08822]
  cd(0:1, 40) = [-17.99998479605043, 0.08224]
  cd(0:1, 41) = [-17.000001556208606, 0.07626]
  cd(0:1, 42) = [-16.000018316366777, 0.07028]
  cd(0:1, 43) = [-14.99997778074544, 0.0643]
  cd(0:1, 44) = [-13.999994540903614, 0.05832]
  cd(0:1, 45) = [-13.499974273092944, 0.05533]
  cd(0:1, 46) = [-13.000011301061788, 0.05234]
  cd(0:1, 47) = [-12.499991033251119, 0.04935]
  cd(0:1, 48) = [-12.000028061219961, 0.04636]
  cd(0:1, 49) = [-11.500007793409292, 0.04337]
  cd(0:1, 50) = [-10.999987525598621, 0.04038]
  cd(0:1, 51) = [-10.500024553567467, 0.03739]
  cd(0:1, 52) = [-10.000004285756797, 0.0344]
  cd(0:1, 53) = [-9.499984017946128, 0.03393]
  cd(0:1, 54) = [-9.000021045914972, 0.03346]
  cd(0:1, 55) = [-8.500000778104303, 0.03299]
  cd(0:1, 56) = [-7.999980510293632, 0.03251]
  cd(0:1, 57) = [-7.500017538262475, 0.03204]
  cd(0:1, 58) = [-6.999997270451807, 0.03157]
  cd(0:1, 59) = [-6.499977002641137, 0.0311]
  cd(0:1, 60) = [-6.0000140306099805, 0.03063]
  cd(0:1, 61) = [-5.499993762799311, 0.03016]
  cd(0:1, 62) = [-4.999973494988642, 0.02969]
  cd(0:1, 63) = [-4.500010522957486, 0.02921]
  cd(0:1, 64) = [-3.999990255146816, 0.02874]
  cd(0:1, 65) = [-3.50002728311566, 0.02827]
  cd(0:1, 66) = [-3.0000070153049903, 0.0278]
  cd(0:1, 67) = [-2.499986747494321, 0.0278]
  cd(0:1, 68) = [-2.0000237754631645, 0.0278]
  cd(0:1, 69) = [-1.5000035076524951, 0.0278]
  cd(0:1, 70) = [-0.9999832398418258, 0.0278]
  cd(0:1, 71) = [-0.5000202678106694, 0.0279]
  cd(0:1, 72) = [0.0, 0.0279]
  cd(0:1, 73) = [0.5000202678106694, 0.0279]
  cd(0:1, 74) = [0.9999832398418258, 0.0279]
  cd(0:1, 75) = [1.5000035076524951, 0.0279]
  cd(0:1, 76) = [2.0000237754631645, 0.028]
  cd(0:1, 77) = [2.499986747494321, 0.028]
  cd(0:1, 78) = [3.0000070153049903, 0.028]
  cd(0:1, 79) = [3.50002728311566, 0.028]
  cd(0:1, 80) = [3.999990255146816, 0.0281]
  cd(0:1, 81) = [4.500010522957486, 0.0281]
  cd(0:1, 82) = [4.999973494988642, 0.0281]
  cd(0:1, 83) = [5.499993762799311, 0.0282]
  cd(0:1, 84) = [6.0000140306099805, 0.0282]
  cd(0:1, 85) = [6.499977002641137, 0.0282]
  cd(0:1, 86) = [6.999997270451807, 0.0283]
  cd(0:1, 87) = [7.500017538262475, 0.0283]
  cd(0:1, 88) = [7.999980510293632, 0.0283]
  cd(0:1, 89) = [8.500000778104303, 0.0284]
  cd(0:1, 90) = [9.000021045914972, 0.0285]
  cd(0:1, 91) = [9.499984017946128, 0.0286]
  cd(0:1, 92) = [10.000004285756797, 0.0287]
  cd(0:1, 93) = [10.500024553567467, 0.0288]
  cd(0:1, 94) = [10.999987525598621, 0.029]
  cd(0:1, 95) = [11.500007793409292, 0.0292]
  cd(0:1, 96) = [12.000028061219961, 0.0301]
  cd(0:1, 97) = [12.499991033251119, 0.0334]
  cd(0:1, 98) = [13.000011301061788, 0.0351]
  cd(0:1, 99) = [13.499974273092944, 0.0365]
  cd(0:1, 100) = [13.999994540903614, 0.0377]
  cd(0:1, 101) = [14.99997778074544, 0.0393]
  cd(0:1, 102) = [16.000018316366777, 0.04]
  cd(0:1, 103) = [17.000001556208606, 0.05355]
  cd(0:1, 104) = [17.99998479605043, 0.0671]
  cd(0:1, 105) = [19.000025331671768, 0.08065]
  cd(0:1, 106) = [20.000008571513593, 0.0942]
  cd(0:1, 107) = [21.999975051197243, 0.1294]
  cd(0:1, 108) = [23.99999882666041, 0.1646]
  cd(0:1, 109) = [26.000022602123575, 0.1998]
  cd(0:1, 110) = [27.99998908180723, 0.235]
  cd(0:1, 111) = [30.000012857270395, 0.2702]
  cd(0:1, 112) = [31.999979336954045, 0.31352]
  cd(0:1, 113) = [34.00000311241721, 0.35684]
  cd(0:1, 114) = [36.00002688788037, 0.40016]
  cd(0:1, 115) = [37.999993367564024, 0.44348]
  cd(0:1, 116) = [40.000017143027186, 0.4868]
  cd(0:1, 117) = [44.99999063801583, 0.6025]
  cd(0:1, 118) = [50.00002142878399, 0.7182]
  cd(0:1, 119) = [54.999994923772626, 0.82775]
  cd(0:1, 120) = [60.00002571454079, 0.9373]
  cd(0:1, 121) = [64.99999920952942, 1.0279]
  cd(0:1, 122) = [69.99997270451807, 1.1185]
  cd(0:1, 123) = [75.00000349528622, 1.17955]
  cd(0:1, 124) = [79.99997699027486, 1.2406]
  cd(0:1, 125) = [85.00000778104302, 1.2653]
  cd(0:1, 126) = [89.99998127603166, 1.29]
  cd(0:1, 127) = [95.00001206679983, 1.2653]
  cd(0:1, 128) = [99.99998556178845, 1.2406]
  cd(0:1, 129) = [105.0000163525566, 1.17955]
  cd(0:1, 130) = [109.99998984754525, 1.1185]
  cd(0:1, 131) = [115.0000206383134, 1.0279]
  cd(0:1, 132) = [119.99999413330205, 0.9373]
  cd(0:1, 133) = [125.00002492407022, 0.82775]
  cd(0:1, 134) = [129.99999841905884, 0.7182]
  cd(0:1, 135) = [134.99997191404748, 0.6025]
  cd(0:1, 136) = [140.00000270481564, 0.4868]
  cd(0:1, 137) = [144.9999761998043, 0.3785]
  cd(0:1, 138) = [150.00000699057244, 0.2702]
  cd(0:1, 139) = [154.99998048556108, 0.1822]
  cd(0:1, 140) = [160.00001127632925, 0.0942]
  cd(0:1, 141) = [164.99998477131788, 0.0521]
  cd(0:1, 142) = [170.00001556208605, 0.01]
  cd(0:1, 143) = [174.99998905707469, 0.01]
  cd(0:1, 144) = [179.96604345059157, 0.01]
  
  IF ( y .EQ. cd(0,0) ) cd3 = cd(1,0)
  DO i = 1,ns-1
     IF ( ( y .GT. cd(0,i-1) ) .AND. (y .LE. cd(0,i) ) ) THEN
        cd3 = cd(1,i-1) + (y - cd(0,i-1))*( ( cd(1,i) - cd(1,i-1) )/( cd(0,i) - cd(0,i-1) ) )
        GOTO 1
     ENDIF
  ENDDO
1 CONTINUE
  
  IF ( y .LT. cd(0,0) ) THEN
     cd3 = cd(1,0)
!     PRINT*,'alpha < tabulated range in calc_cd3_nrel28.pro'
  ENDIF
  IF ( y .GT. cd(0,ns-1) ) THEN
     cd3 = cd(1,ns-1)
!     PRINT*,'alpha > tabulated range in calc_cd3_nrel28.pro'
  ENDIF
!_________________________________________________________________________
  
END FUNCTION calc_cd3_nrel28
!_________________________________________________________________________


!=========================================================================

FUNCTION calc_cd4_nrel28( y ) RESULT( cd4 )
!_________________________________________________________________________
! 
! Data from DU00-W2-350
!_________________________________________________________________________
  
  REAL, INTENT( IN ) :: y

  REAL, PARAMETER :: ns = 145

  REAL, DIMENSION( 0:1,0:ns-1 ) :: cd

  REAL :: cd4
  INTEGER :: i

  cd4 = 0.0

  cd(0:1, 0) = [-179.9087476710785, 0.053549]
  cd(0:1, 1) = [-174.99998905707469, 0.053549]
  cd(0:1, 2) = [-170.00001556208605, 0.107097]
  cd(0:1, 3) = [-164.99998477131788, 0.163118]
  cd(0:1, 4) = [-160.00001127632925, 0.219139]
  cd(0:1, 5) = [-154.99998048556108, 0.313857]
  cd(0:1, 6) = [-150.00000699057244, 0.408574]
  cd(0:1, 7) = [-144.9999761998043, 0.524511]
  cd(0:1, 8) = [-140.00000270481564, 0.640447]
  cd(0:1, 9) = [-134.99997191404748, 0.763384]
  cd(0:1, 10) = [-129.99999841905884, 0.88632]
  cd(0:1, 11) = [-125.00002492407022, 1.001135]
  cd(0:1, 12) = [-119.99999413330205, 1.11595]
  cd(0:1, 13) = [-115.0000206383134, 1.208465]
  cd(0:1, 14) = [-109.99998984754525, 1.30098]
  cd(0:1, 15) = [-105.0000163525566, 1.359655]
  cd(0:1, 16) = [-99.99998556178845, 1.41833]
  cd(0:1, 17) = [-95.00001206679983, 1.435695]
  cd(0:1, 18) = [-89.99998127603166, 1.45306]
  cd(0:1, 19) = [-85.00000778104302, 1.435695]
  cd(0:1, 20) = [-79.99997699027486, 1.41833]
  cd(0:1, 21) = [-75.00000349528622, 1.359655]
  cd(0:1, 22) = [-69.99997270451807, 1.30098]
  cd(0:1, 23) = [-64.99999920952942, 1.208465]
  cd(0:1, 24) = [-60.00002571454079, 1.11595]
  cd(0:1, 25) = [-54.999994923772626, 1.001135]
  cd(0:1, 26) = [-50.00002142878399, 0.88632]
  cd(0:1, 27) = [-44.99999063801583, 0.763524]
  cd(0:1, 28) = [-40.000017143027186, 0.640447]
  cd(0:1, 29) = [-37.999993367564024, 0.591994]
  cd(0:1, 30) = [-36.00002688788037, 0.544346]
  cd(0:1, 31) = [-34.00000311241721, 0.497741]
  cd(0:1, 32) = [-31.999979336954045, 0.452409]
  cd(0:1, 33) = [-30.000012857270395, 0.408574]
  cd(0:1, 34) = [-27.99998908180723, 0.366454]
  cd(0:1, 35) = [-26.000022602123575, 0.326257]
  cd(0:1, 36) = [-23.99999882666041, 0.288182]
  cd(0:1, 37) = [-21.999975051197243, 0.252417]
  cd(0:1, 38) = [-20.000008571513593, 0.219139]
  cd(0:1, 39) = [-19.000025331671768, 0.203631]
  cd(0:1, 40) = [-17.99998479605043, 0.188123]
  cd(0:1, 41) = [-17.000001556208606, 0.172615]
  cd(0:1, 42) = [-16.000018316366777, 0.157106]
  cd(0:1, 43) = [-14.99997778074544, 0.141598]
  cd(0:1, 44) = [-13.999994540903614, 0.12609]
  cd(0:1, 45) = [-13.499974273092944, 0.118336]
  cd(0:1, 46) = [-13.000011301061788, 0.110581]
  cd(0:1, 47) = [-12.499991033251119, 0.102827]
  cd(0:1, 48) = [-12.000028061219961, 0.095073]
  cd(0:1, 49) = [-11.500007793409292, 0.087319]
  cd(0:1, 50) = [-10.999987525598621, 0.079565]
  cd(0:1, 51) = [-10.500024553567467, 0.071811]
  cd(0:1, 52) = [-10.000004285756797, 0.064057]
  cd(0:1, 53) = [-9.499984017946128, 0.056302]
  cd(0:1, 54) = [-9.000021045914972, 0.048548]
  cd(0:1, 55) = [-8.500000778104303, 0.040794]
  cd(0:1, 56) = [-7.999980510293632, 0.03304]
  cd(0:1, 57) = [-7.500017538262475, 0.029418]
  cd(0:1, 58) = [-6.999997270451807, 0.025795]
  cd(0:1, 59) = [-6.499977002641137, 0.02266]
  cd(0:1, 60) = [-6.0000140306099805, 0.019525]
  cd(0:1, 61) = [-5.499993762799311, 0.017658]
  cd(0:1, 62) = [-4.999973494988642, 0.01579]
  cd(0:1, 63) = [-4.500010522957486, 0.014298]
  cd(0:1, 64) = [-3.999990255146816, 0.012805]
  cd(0:1, 65) = [-3.50002728311566, 0.012348]
  cd(0:1, 66) = [-3.0000070153049903, 0.01189]
  cd(0:1, 67) = [-2.499986747494321, 0.011298]
  cd(0:1, 68) = [-2.0000237754631645, 0.010705]
  cd(0:1, 69) = [-1.5000035076524951, 0.010518]
  cd(0:1, 70) = [-0.9999832398418258, 0.01033]
  cd(0:1, 71) = [-0.5000202678106694, 0.010233]
  cd(0:1, 72) = [0.0, 0.010135]
  cd(0:1, 73) = [0.5000202678106694, 0.010128]
  cd(0:1, 74) = [0.9999832398418258, 0.01012]
  cd(0:1, 75) = [1.5000035076524951, 0.010293]
  cd(0:1, 76) = [2.0000237754631645, 0.010465]
  cd(0:1, 77) = [2.499986747494321, 0.010638]
  cd(0:1, 78) = [3.0000070153049903, 0.01081]
  cd(0:1, 79) = [3.50002728311566, 0.01108]
  cd(0:1, 80) = [3.999990255146816, 0.01135]
  cd(0:1, 81) = [4.500010522957486, 0.011718]
  cd(0:1, 82) = [4.999973494988642, 0.012085]
  cd(0:1, 83) = [5.499993762799311, 0.012468]
  cd(0:1, 84) = [6.0000140306099805, 0.01285]
  cd(0:1, 85) = [6.499977002641137, 0.013383]
  cd(0:1, 86) = [6.999997270451807, 0.013915]
  cd(0:1, 87) = [7.500017538262475, 0.014628]
  cd(0:1, 88) = [7.999980510293632, 0.01534]
  cd(0:1, 89) = [8.500000778104303, 0.016295]
  cd(0:1, 90) = [9.000021045914972, 0.01725]
  cd(0:1, 91) = [9.499984017946128, 0.019723]
  cd(0:1, 92) = [10.000004285756797, 0.022195]
  cd(0:1, 93) = [10.500024553567467, 0.025773]
  cd(0:1, 94) = [10.999987525598621, 0.02935]
  cd(0:1, 95) = [11.500007793409292, 0.035148]
  cd(0:1, 96) = [12.000028061219961, 0.040945]
  cd(0:1, 97) = [12.499991033251119, 0.04984]
  cd(0:1, 98) = [13.000011301061788, 0.058735]
  cd(0:1, 99) = [13.499974273092944, 0.06919]
  cd(0:1, 100) = [13.999994540903614, 0.079645]
  cd(0:1, 101) = [14.99997778074544, 0.103435]
  cd(0:1, 102) = [16.000018316366777, 0.12955]
  cd(0:1, 103) = [17.000001556208606, 0.15439]
  cd(0:1, 104) = [17.99998479605043, 0.17908]
  cd(0:1, 105) = [19.000025331671768, 0.203485]
  cd(0:1, 106) = [20.000008571513593, 0.219139]
  cd(0:1, 107) = [21.999975051197243, 0.252417]
  cd(0:1, 108) = [23.99999882666041, 0.288182]
  cd(0:1, 109) = [26.000022602123575, 0.326257]
  cd(0:1, 110) = [27.99998908180723, 0.366454]
  cd(0:1, 111) = [30.000012857270395, 0.408574]
  cd(0:1, 112) = [31.999979336954045, 0.452409]
  cd(0:1, 113) = [34.00000311241721, 0.497741]
  cd(0:1, 114) = [36.00002688788037, 0.544346]
  cd(0:1, 115) = [37.999993367564024, 0.591994]
  cd(0:1, 116) = [40.000017143027186, 0.640447]
  cd(0:1, 117) = [44.99999063801583, 0.763524]
  cd(0:1, 118) = [50.00002142878399, 0.88632]
  cd(0:1, 119) = [54.999994923772626, 1.001135]
  cd(0:1, 120) = [60.00002571454079, 1.11595]
  cd(0:1, 121) = [64.99999920952942, 1.208465]
  cd(0:1, 122) = [69.99997270451807, 1.30098]
  cd(0:1, 123) = [75.00000349528622, 1.359655]
  cd(0:1, 124) = [79.99997699027486, 1.41833]
  cd(0:1, 125) = [85.00000778104302, 1.435695]
  cd(0:1, 126) = [89.99998127603166, 1.45306]
  cd(0:1, 127) = [95.00001206679983, 1.435695]
  cd(0:1, 128) = [99.99998556178845, 1.41833]
  cd(0:1, 129) = [105.0000163525566, 1.359655]
  cd(0:1, 130) = [109.99998984754525, 1.30098]
  cd(0:1, 131) = [115.0000206383134, 1.208465]
  cd(0:1, 132) = [119.99999413330205, 1.11595]
  cd(0:1, 133) = [125.00002492407022, 1.001135]
  cd(0:1, 134) = [129.99999841905884, 0.88632]
  cd(0:1, 135) = [134.99997191404748, 0.763384]
  cd(0:1, 136) = [140.00000270481564, 0.640447]
  cd(0:1, 137) = [144.9999761998043, 0.524511]
  cd(0:1, 138) = [150.00000699057244, 0.408574]
  cd(0:1, 139) = [154.99998048556108, 0.313857]
  cd(0:1, 140) = [160.00001127632925, 0.219139]
  cd(0:1, 141) = [164.99998477131788, 0.164355]
  cd(0:1, 142) = [170.00001556208605, 0.10957]
  cd(0:1, 143) = [174.99998905707469, 0.054785]
  cd(0:1, 144) = [179.9087476710785, 0.053549]
  
  IF ( y .EQ. cd(0,0) ) cd4 = cd(1,0)
  DO i = 1,ns-1
     IF ( ( y .GT. cd(0,i-1) ) .AND. (y .LE. cd(0,i) ) ) THEN
        cd4 = cd(1,i-1) + (y - cd(0,i-1))*( ( cd(1,i) - cd(1,i-1) )/( cd(0,i) - cd(0,i-1) ) )
        GOTO 1
     ENDIF
  ENDDO
1 CONTINUE
  
  IF ( y .LT. cd(0,0) ) THEN
     cd4 = cd(1,0)
!     PRINT*,'alpha < tabulated range in calc_cd4_nrel28.pro'
  ENDIF
  IF ( y .GT. cd(0,ns-1) ) THEN
     cd4 = cd(1,ns-1)
!     PRINT*,'alpha > tabulated range in calc_cd4_nrel28.pro'
  ENDIF
!_________________________________________________________________________
  
END FUNCTION calc_cd4_nrel28
!_________________________________________________________________________


!=========================================================================

FUNCTION calc_cd5_nrel28( y ) RESULT( cd5 )
!_________________________________________________________________________
! 
! Data from DU97-W-300
!_________________________________________________________________________
  
  REAL, INTENT( IN ) :: y

  REAL, PARAMETER :: ns = 145

  REAL, DIMENSION( 0:1,0:ns-1 ) :: cd

  REAL :: cd5
  INTEGER :: i

  cd5 = 0.0

!                alpha    CD   
  cd(0:1, 0) = [-179.96604345059157, 0.046744]
  cd(0:1, 1) = [-174.99998905707469, 0.046744]
  cd(0:1, 2) = [-170.00001556208605, 0.093488]
  cd(0:1, 3) = [-164.99998477131788, 0.140231]
  cd(0:1, 4) = [-160.00001127632925, 0.186975]
  cd(0:1, 5) = [-154.99998048556108, 0.278952]
  cd(0:1, 6) = [-150.00000699057244, 0.370928]
  cd(0:1, 7) = [-144.9999761998043, 0.489038]
  cd(0:1, 8) = [-140.00000270481564, 0.607148]
  cd(0:1, 9) = [-134.99997191404748, 0.732763]
  cd(0:1, 10) = [-129.99999841905884, 0.858378]
  cd(0:1, 11) = [-125.00002492407022, 0.976299]
  cd(0:1, 12) = [-119.99999413330205, 1.09422]
  cd(0:1, 13) = [-115.0000206383134, 1.190165]
  cd(0:1, 14) = [-109.99998984754525, 1.28611]
  cd(0:1, 15) = [-105.0000163525566, 1.348445]
  cd(0:1, 16) = [-99.99998556178845, 1.41078]
  cd(0:1, 17) = [-95.00001206679983, 1.43192]
  cd(0:1, 18) = [-89.99998127603166, 1.45306]
  cd(0:1, 19) = [-85.00000778104302, 1.43192]
  cd(0:1, 20) = [-79.99997699027486, 1.41078]
  cd(0:1, 21) = [-75.00000349528622, 1.348445]
  cd(0:1, 22) = [-69.99997270451807, 1.28611]
  cd(0:1, 23) = [-64.99999920952942, 1.190165]
  cd(0:1, 24) = [-60.00002571454079, 1.09422]
  cd(0:1, 25) = [-54.999994923772626, 0.976299]
  cd(0:1, 26) = [-50.00002142878399, 0.858378]
  cd(0:1, 27) = [-44.99999063801583, 0.732787]
  cd(0:1, 28) = [-40.000017143027186, 0.607148]
  cd(0:1, 29) = [-37.999993367564024, 0.557739]
  cd(0:1, 30) = [-36.00002688788037, 0.509179]
  cd(0:1, 31) = [-34.00000311241721, 0.461703]
  cd(0:1, 32) = [-31.999979336954045, 0.415545]
  cd(0:1, 33) = [-30.000012857270395, 0.370928]
  cd(0:1, 34) = [-27.99998908180723, 0.328073]
  cd(0:1, 35) = [-26.000022602123575, 0.287187]
  cd(0:1, 36) = [-23.99999882666041, 0.248471]
  cd(0:1, 37) = [-21.999975051197243, 0.212113]
  cd(0:1, 38) = [-20.000008571513593, 0.196875]
  cd(0:1, 39) = [-19.000025331671768, 0.189256]
  cd(0:1, 40) = [-17.99998479605043, 0.181638]
  cd(0:1, 41) = [-17.000001556208606, 0.174019]
  cd(0:1, 42) = [-16.000018316366777, 0.1664]
  cd(0:1, 43) = [-14.99997778074544, 0.154969]
  cd(0:1, 44) = [-13.999994540903614, 0.136588]
  cd(0:1, 45) = [-13.499974273092944, 0.126791]
  cd(0:1, 46) = [-13.000011301061788, 0.116994]
  cd(0:1, 47) = [-12.499991033251119, 0.107563]
  cd(0:1, 48) = [-12.000028061219961, 0.098133]
  cd(0:1, 49) = [-11.500007793409292, 0.090456]
  cd(0:1, 50) = [-10.999987525598621, 0.08278]
  cd(0:1, 51) = [-10.500024553567467, 0.076227]
  cd(0:1, 52) = [-10.000004285756797, 0.069674]
  cd(0:1, 53) = [-9.499984017946128, 0.059813]
  cd(0:1, 54) = [-9.000021045914972, 0.049952]
  cd(0:1, 55) = [-8.500000778104303, 0.037014]
  cd(0:1, 56) = [-7.999980510293632, 0.024076]
  cd(0:1, 57) = [-7.500017538262475, 0.020586]
  cd(0:1, 58) = [-6.999997270451807, 0.017096]
  cd(0:1, 59) = [-6.499977002641137, 0.015875]
  cd(0:1, 60) = [-6.0000140306099805, 0.014654]
  cd(0:1, 61) = [-5.499993762799311, 0.013686]
  cd(0:1, 62) = [-4.999973494988642, 0.012718]
  cd(0:1, 63) = [-4.500010522957486, 0.012112]
  cd(0:1, 64) = [-3.999990255146816, 0.011506]
  cd(0:1, 65) = [-3.50002728311566, 0.011162]
  cd(0:1, 66) = [-3.0000070153049903, 0.010863]
  cd(0:1, 67) = [-2.499986747494321, 0.01071]
  cd(0:1, 68) = [-2.0000237754631645, 0.010563]
  cd(0:1, 69) = [-1.5000035076524951, 0.010439]
  cd(0:1, 70) = [-0.9999832398418258, 0.010323]
  cd(0:1, 71) = [-0.5000202678106694, 0.010388]
  cd(0:1, 72) = [0.0, 0.010455]
  cd(0:1, 73) = [0.5000202678106694, 0.01054]
  cd(0:1, 74) = [0.9999832398418258, 0.010619]
  cd(0:1, 75) = [1.5000035076524951, 0.01061]
  cd(0:1, 76) = [2.0000237754631645, 0.010601]
  cd(0:1, 77) = [2.499986747494321, 0.010749]
  cd(0:1, 78) = [3.0000070153049903, 0.010911]
  cd(0:1, 79) = [3.50002728311566, 0.011025]
  cd(0:1, 80) = [3.999990255146816, 0.011132]
  cd(0:1, 81) = [4.500010522957486, 0.011276]
  cd(0:1, 82) = [4.999973494988642, 0.01142]
  cd(0:1, 83) = [5.499993762799311, 0.011627]
  cd(0:1, 84) = [6.0000140306099805, 0.011833]
  cd(0:1, 85) = [6.499977002641137, 0.012097]
  cd(0:1, 86) = [6.999997270451807, 0.01236]
  cd(0:1, 87) = [7.500017538262475, 0.012668]
  cd(0:1, 88) = [7.999980510293632, 0.012976]
  cd(0:1, 89) = [8.500000778104303, 0.013424]
  cd(0:1, 90) = [9.000021045914972, 0.013873]
  cd(0:1, 91) = [9.499984017946128, 0.014483]
  cd(0:1, 92) = [10.000004285756797, 0.015094]
  cd(0:1, 93) = [10.500024553567467, 0.015984]
  cd(0:1, 94) = [10.999987525598621, 0.016873]
  cd(0:1, 95) = [11.500007793409292, 0.018453]
  cd(0:1, 96) = [12.000028061219961, 0.020032]
  cd(0:1, 97) = [12.499991033251119, 0.039607]
  cd(0:1, 98) = [13.000011301061788, 0.059182]
  cd(0:1, 99) = [13.499974273092944, 0.066951]
  cd(0:1, 100) = [13.999994540903614, 0.074721]
  cd(0:1, 101) = [14.99997778074544, 0.088786]
  cd(0:1, 102) = [16.000018316366777, 0.102696]
  cd(0:1, 103) = [17.000001556208606, 0.117178]
  cd(0:1, 104) = [17.99998479605043, 0.132916]
  cd(0:1, 105) = [19.000025331671768, 0.152774]
  cd(0:1, 106) = [20.000008571513593, 0.173387]
  cd(0:1, 107) = [21.999975051197243, 0.212113]
  cd(0:1, 108) = [23.99999882666041, 0.248471]
  cd(0:1, 109) = [26.000022602123575, 0.287187]
  cd(0:1, 110) = [27.99998908180723, 0.328073]
  cd(0:1, 111) = [30.000012857270395, 0.370928]
  cd(0:1, 112) = [31.999979336954045, 0.415545]
  cd(0:1, 113) = [34.00000311241721, 0.461703]
  cd(0:1, 114) = [36.00002688788037, 0.509179]
  cd(0:1, 115) = [37.999993367564024, 0.557739]
  cd(0:1, 116) = [40.000017143027186, 0.607148]
  cd(0:1, 117) = [44.99999063801583, 0.732787]
  cd(0:1, 118) = [50.00002142878399, 0.858378]
  cd(0:1, 119) = [54.999994923772626, 0.976299]
  cd(0:1, 120) = [60.00002571454079, 1.09422]
  cd(0:1, 121) = [64.99999920952942, 1.190165]
  cd(0:1, 122) = [69.99997270451807, 1.28611]
  cd(0:1, 123) = [75.00000349528622, 1.348445]
  cd(0:1, 124) = [79.99997699027486, 1.41078]
  cd(0:1, 125) = [85.00000778104302, 1.43192]
  cd(0:1, 126) = [89.99998127603166, 1.45306]
  cd(0:1, 127) = [95.00001206679983, 1.43192]
  cd(0:1, 128) = [99.99998556178845, 1.41078]
  cd(0:1, 129) = [105.0000163525566, 1.348445]
  cd(0:1, 130) = [109.99998984754525, 1.28611]
  cd(0:1, 131) = [115.0000206383134, 1.190165]
  cd(0:1, 132) = [119.99999413330205, 1.09422]
  cd(0:1, 133) = [125.00002492407022, 0.976299]
  cd(0:1, 134) = [129.99999841905884, 0.858378]
  cd(0:1, 135) = [134.99997191404748, 0.732763]
  cd(0:1, 136) = [140.00000270481564, 0.607148]
  cd(0:1, 137) = [144.9999761998043, 0.489038]
  cd(0:1, 138) = [150.00000699057244, 0.370928]
  cd(0:1, 139) = [154.99998048556108, 0.281879]
  cd(0:1, 140) = [160.00001127632925, 0.19283]
  cd(0:1, 141) = [164.99998477131788, 0.144623]
  cd(0:1, 142) = [170.00001556208605, 0.096415]
  cd(0:1, 143) = [174.99998905707469, 0.048208]
  cd(0:1, 144) = [179.96604345059157, 0.046744]

  IF ( y .EQ. cd(0,0) ) cd5 = cd(1,0)
  DO i = 1,ns-1
     IF ( ( y .GT. cd(0,i-1) ) .AND. (y .LE. cd(0,i) ) ) THEN
        cd5 = cd(1,i-1) + (y - cd(0,i-1))*( ( cd(1,i) - cd(1,i-1) )/( cd(0,i) - cd(0,i-1) ) )
        GOTO 1
     ENDIF
  ENDDO
1 CONTINUE
  
  IF ( y .LT. cd(0,0) ) THEN
     cd5 = cd(1,0)
!     PRINT*,'alpha < tabulated range in calc_cd5_nrel28.pro'
  ENDIF
  IF ( y .GT. cd(0,ns-1) ) THEN
     cd5 = cd(1,ns-1)
!     PRINT*,'alpha > tabulated range in calc_cd5_nrel28.pro'
  ENDIF
!_________________________________________________________________________
  
END FUNCTION calc_cd5_nrel28
!_________________________________________________________________________

!=========================================================================

FUNCTION calc_cd6_nrel28( y ) RESULT( cd6 )
!_________________________________________________________________________
! 
! Data from DU91-W2-250
!_________________________________________________________________________
  
  REAL, INTENT( IN ) :: y

  REAL, PARAMETER :: ns = 145

  REAL, DIMENSION( 0:1,0:ns-1 ) :: cd

  REAL :: cd6
  INTEGER :: i

  cd6 = 0.0

!                alpha    CD   
  cd(0:1, 0) = [-179.96604345059157, 0.056205]
  cd(0:1, 1) = [-174.99998905707469, 0.056205]
  cd(0:1, 2) = [-170.00001556208605, 0.11241]
  cd(0:1, 3) = [-164.99998477131788, 0.168615]
  cd(0:1, 4) = [-160.00001127632925, 0.224819]
  cd(0:1, 5) = [-154.99998048556108, 0.31385]
  cd(0:1, 6) = [-150.00000699057244, 0.40288]
  cd(0:1, 7) = [-144.9999761998043, 0.519146]
  cd(0:1, 8) = [-140.00000270481564, 0.635411]
  cd(0:1, 9) = [-134.99997191404748, 0.758753]
  cd(0:1, 10) = [-129.99999841905884, 0.882094]
  cd(0:1, 11) = [-125.00002492407022, 0.997382]
  cd(0:1, 12) = [-119.99999413330205, 1.11267]
  cd(0:1, 13) = [-115.0000206383134, 1.2057]
  cd(0:1, 14) = [-109.99998984754525, 1.29873]
  cd(0:1, 15) = [-105.0000163525566, 1.35796]
  cd(0:1, 16) = [-99.99998556178845, 1.41719]
  cd(0:1, 17) = [-95.00001206679983, 1.435125]
  cd(0:1, 18) = [-89.99998127603166, 1.45306]
  cd(0:1, 19) = [-85.00000778104302, 1.435125]
  cd(0:1, 20) = [-79.99997699027486, 1.41719]
  cd(0:1, 21) = [-75.00000349528622, 1.35796]
  cd(0:1, 22) = [-69.99997270451807, 1.29873]
  cd(0:1, 23) = [-64.99999920952942, 1.2057]
  cd(0:1, 24) = [-60.00002571454079, 1.11267]
  cd(0:1, 25) = [-54.999994923772626, 0.997382]
  cd(0:1, 26) = [-50.00002142878399, 0.882094]
  cd(0:1, 27) = [-44.99999063801583, 0.758875]
  cd(0:1, 28) = [-40.000017143027186, 0.635411]
  cd(0:1, 29) = [-37.999993367564024, 0.586813]
  cd(0:1, 30) = [-36.00002688788037, 0.539027]
  cd(0:1, 31) = [-34.00000311241721, 0.49229]
  cd(0:1, 32) = [-31.999979336954045, 0.446833]
  cd(0:1, 33) = [-30.000012857270395, 0.40288]
  cd(0:1, 34) = [-27.99998908180723, 0.360649]
  cd(0:1, 35) = [-26.000022602123575, 0.320348]
  cd(0:1, 36) = [-23.99999882666041, 0.282176]
  cd(0:1, 37) = [-21.999975051197243, 0.24608]
  cd(0:1, 38) = [-20.000008571513593, 0.210344]
  cd(0:1, 39) = [-19.000025331671768, 0.192477]
  cd(0:1, 40) = [-17.99998479605043, 0.174609]
  cd(0:1, 41) = [-17.000001556208606, 0.156741]
  cd(0:1, 42) = [-16.000018316366777, 0.138874]
  cd(0:1, 43) = [-14.99997778074544, 0.121006]
  cd(0:1, 44) = [-13.999994540903614, 0.103139]
  cd(0:1, 45) = [-13.499974273092944, 0.094205]
  cd(0:1, 46) = [-13.000011301061788, 0.085271]
  cd(0:1, 47) = [-12.499991033251119, 0.074523]
  cd(0:1, 48) = [-12.000028061219961, 0.063774]
  cd(0:1, 49) = [-11.500007793409292, 0.054523]
  cd(0:1, 50) = [-10.999987525598621, 0.045271]
  cd(0:1, 51) = [-10.500024553567467, 0.038421]
  cd(0:1, 52) = [-10.000004285756797, 0.03157]
  cd(0:1, 53) = [-9.499984017946128, 0.026128]
  cd(0:1, 54) = [-9.000021045914972, 0.020687]
  cd(0:1, 55) = [-8.500000778104303, 0.016735]
  cd(0:1, 56) = [-7.999980510293632, 0.012784]
  cd(0:1, 57) = [-7.500017538262475, 0.011634]
  cd(0:1, 58) = [-6.999997270451807, 0.010484]
  cd(0:1, 59) = [-6.499977002641137, 0.009764]
  cd(0:1, 60) = [-6.0000140306099805, 0.009045]
  cd(0:1, 61) = [-5.499993762799311, 0.00874]
  cd(0:1, 62) = [-4.999973494988642, 0.008435]
  cd(0:1, 63) = [-4.500010522957486, 0.008292]
  cd(0:1, 64) = [-3.999990255146816, 0.008148]
  cd(0:1, 65) = [-3.50002728311566, 0.007979]
  cd(0:1, 66) = [-3.0000070153049903, 0.007822]
  cd(0:1, 67) = [-2.499986747494321, 0.007706]
  cd(0:1, 68) = [-2.0000237754631645, 0.007602]
  cd(0:1, 69) = [-1.5000035076524951, 0.007558]
  cd(0:1, 70) = [-0.9999832398418258, 0.007528]
  cd(0:1, 71) = [-0.5000202678106694, 0.007596]
  cd(0:1, 72) = [0.0, 0.00766]
  cd(0:1, 73) = [0.5000202678106694, 0.00766]
  cd(0:1, 74) = [0.9999832398418258, 0.00766]
  cd(0:1, 75) = [1.5000035076524951, 0.00766]
  cd(0:1, 76) = [2.0000237754631645, 0.007794]
  cd(0:1, 77) = [2.499986747494321, 0.007933]
  cd(0:1, 78) = [3.0000070153049903, 0.008057]
  cd(0:1, 79) = [3.50002728311566, 0.008178]
  cd(0:1, 80) = [3.999990255146816, 0.008311]
  cd(0:1, 81) = [4.500010522957486, 0.008483]
  cd(0:1, 82) = [4.999973494988642, 0.008655]
  cd(0:1, 83) = [5.499993762799311, 0.008905]
  cd(0:1, 84) = [6.0000140306099805, 0.009154]
  cd(0:1, 85) = [6.499977002641137, 0.009482]
  cd(0:1, 86) = [6.999997270451807, 0.00981]
  cd(0:1, 87) = [7.500017538262475, 0.010551]
  cd(0:1, 88) = [7.999980510293632, 0.011292]
  cd(0:1, 89) = [8.500000778104303, 0.012992]
  cd(0:1, 90) = [9.000021045914972, 0.014693]
  cd(0:1, 91) = [9.499984017946128, 0.025407]
  cd(0:1, 92) = [10.000004285756797, 0.03612]
  cd(0:1, 93) = [10.500024553567467, 0.045521]
  cd(0:1, 94) = [10.999987525598621, 0.054921]
  cd(0:1, 95) = [11.500007793409292, 0.058957]
  cd(0:1, 96) = [12.000028061219961, 0.062993]
  cd(0:1, 97) = [12.499991033251119, 0.069851]
  cd(0:1, 98) = [13.000011301061788, 0.076708]
  cd(0:1, 99) = [13.499974273092944, 0.084991]
  cd(0:1, 100) = [13.999994540903614, 0.093275]
  cd(0:1, 101) = [14.99997778074544, 0.111003]
  cd(0:1, 102) = [16.000018316366777, 0.125282]
  cd(0:1, 103) = [17.000001556208606, 0.137294]
  cd(0:1, 104) = [17.99998479605043, 0.155144]
  cd(0:1, 105) = [19.000025331671768, 0.176312]
  cd(0:1, 106) = [20.000008571513593, 0.195534]
  cd(0:1, 107) = [21.999975051197243, 0.244542]
  cd(0:1, 108) = [23.99999882666041, 0.282176]
  cd(0:1, 109) = [26.000022602123575, 0.320348]
  cd(0:1, 110) = [27.99998908180723, 0.360649]
  cd(0:1, 111) = [30.000012857270395, 0.40288]
  cd(0:1, 112) = [31.999979336954045, 0.446833]
  cd(0:1, 113) = [34.00000311241721, 0.49229]
  cd(0:1, 114) = [36.00002688788037, 0.539027]
  cd(0:1, 115) = [37.999993367564024, 0.586813]
  cd(0:1, 116) = [40.000017143027186, 0.635411]
  cd(0:1, 117) = [44.99999063801583, 0.758875]
  cd(0:1, 118) = [50.00002142878399, 0.882094]
  cd(0:1, 119) = [54.999994923772626, 0.997382]
  cd(0:1, 120) = [60.00002571454079, 1.11267]
  cd(0:1, 121) = [64.99999920952942, 1.2057]
  cd(0:1, 122) = [69.99997270451807, 1.29873]
  cd(0:1, 123) = [75.00000349528622, 1.35796]
  cd(0:1, 124) = [79.99997699027486, 1.41719]
  cd(0:1, 125) = [85.00000778104302, 1.435125]
  cd(0:1, 126) = [89.99998127603166, 1.45306]
  cd(0:1, 127) = [95.00001206679983, 1.435125]
  cd(0:1, 128) = [99.99998556178845, 1.41719]
  cd(0:1, 129) = [105.0000163525566, 1.35796]
  cd(0:1, 130) = [109.99998984754525, 1.29873]
  cd(0:1, 131) = [115.0000206383134, 1.2057]
  cd(0:1, 132) = [119.99999413330205, 1.11267]
  cd(0:1, 133) = [125.00002492407022, 0.997382]
  cd(0:1, 134) = [129.99999841905884, 0.882094]
  cd(0:1, 135) = [134.99997191404748, 0.758753]
  cd(0:1, 136) = [140.00000270481564, 0.635411]
  cd(0:1, 137) = [144.9999761998043, 0.519146]
  cd(0:1, 138) = [150.00000699057244, 0.40288]
  cd(0:1, 139) = [154.99998048556108, 0.3162]
  cd(0:1, 140) = [160.00001127632925, 0.229519]
  cd(0:1, 141) = [164.99998477131788, 0.17214]
  cd(0:1, 142) = [170.00001556208605, 0.11476]
  cd(0:1, 143) = [174.99998905707469, 0.05738]
  cd(0:1, 144) = [179.96604345059157, 0.056205]
 
  IF ( y .EQ. cd(0,0) ) cd6 = cd(1,0)
  DO i = 1,ns-1
     IF ( ( y .GT. cd(0,i-1) ) .AND. (y .LE. cd(0,i) ) ) THEN
        cd6 = cd(1,i-1) + (y - cd(0,i-1))*( ( cd(1,i) - cd(1,i-1) )/( cd(0,i) - cd(0,i-1) ) )
        GOTO 1
     ENDIF
  ENDDO
1 CONTINUE
  
  IF ( y .LT. cd(0,0) ) THEN
     cd6 = cd(1,0)
!     PRINT*,'alpha < tabulated range in calc_cd6_nrel28.pro'
  ENDIF
  IF ( y .GT. cd(0,ns-1) ) THEN
     cd6 = cd(1,ns-1)
!     PRINT*,'alpha > tabulated range in calc_cd6_nrel28.pro'
  ENDIF
!_________________________________________________________________________
  
END FUNCTION calc_cd6_nrel28
!_________________________________________________________________________

!=========================================================================

FUNCTION calc_cd7_nrel28( y ) RESULT( cd7 )
!_________________________________________________________________________
! 
! Data from DU08-W-210
!_________________________________________________________________________
  
  REAL, INTENT( IN ) :: y

  REAL, PARAMETER :: ns = 145

  REAL, DIMENSION( 0:1,0:ns-1 ) :: cd

  REAL :: cd7
  INTEGER :: i

  cd7 = 0.0

!                alpha    CD   
  cd(0:1, 0) = [-179.96604345059157, 0.037696]
  cd(0:1, 1) = [-174.99998905707469, 0.037696]
  cd(0:1, 2) = [-170.00001556208605, 0.075392]
  cd(0:1, 3) = [-164.99998477131788, 0.123869]
  cd(0:1, 4) = [-160.00001127632925, 0.172346]
  cd(0:1, 5) = [-154.99998048556108, 0.268898]
  cd(0:1, 6) = [-150.00000699057244, 0.365449]
  cd(0:1, 7) = [-144.9999761998043, 0.483875]
  cd(0:1, 8) = [-140.00000270481564, 0.602301]
  cd(0:1, 9) = [-134.99997191404748, 0.728306]
  cd(0:1, 10) = [-129.99999841905884, 0.854311]
  cd(0:1, 11) = [-125.00002492407022, 0.972686]
  cd(0:1, 12) = [-119.99999413330205, 1.09106]
  cd(0:1, 13) = [-115.0000206383134, 1.187505]
  cd(0:1, 14) = [-109.99998984754525, 1.28395]
  cd(0:1, 15) = [-105.0000163525566, 1.346815]
  cd(0:1, 16) = [-99.99998556178845, 1.40968]
  cd(0:1, 17) = [-95.00001206679983, 1.43137]
  cd(0:1, 18) = [-89.99998127603166, 1.45306]
  cd(0:1, 19) = [-85.00000778104302, 1.43137]
  cd(0:1, 20) = [-79.99997699027486, 1.40968]
  cd(0:1, 21) = [-75.00000349528622, 1.346815]
  cd(0:1, 22) = [-69.99997270451807, 1.28395]
  cd(0:1, 23) = [-64.99999920952942, 1.187505]
  cd(0:1, 24) = [-60.00002571454079, 1.09106]
  cd(0:1, 25) = [-54.999994923772626, 0.972686]
  cd(0:1, 26) = [-50.00002142878399, 0.854311]
  cd(0:1, 27) = [-44.99999063801583, 0.728313]
  cd(0:1, 28) = [-40.000017143027186, 0.602301]
  cd(0:1, 29) = [-37.999993367564024, 0.552754]
  cd(0:1, 30) = [-36.00002688788037, 0.50406]
  cd(0:1, 31) = [-34.00000311241721, 0.456458]
  cd(0:1, 32) = [-31.999979336954045, 0.410179]
  cd(0:1, 33) = [-30.000012857270395, 0.365449]
  cd(0:1, 34) = [-27.99998908180723, 0.322487]
  cd(0:1, 35) = [-26.000022602123575, 0.281501]
  cd(0:1, 36) = [-23.99999882666041, 0.242691]
  cd(0:1, 37) = [-21.999975051197243, 0.206247]
  cd(0:1, 38) = [-20.000008571513593, 0.172346]
  cd(0:1, 39) = [-19.000025331671768, 0.156402]
  cd(0:1, 40) = [-17.99998479605043, 0.141154]
  cd(0:1, 41) = [-17.000001556208606, 0.127962]
  cd(0:1, 42) = [-16.000018316366777, 0.11477]
  cd(0:1, 43) = [-14.99997778074544, 0.101579]
  cd(0:1, 44) = [-13.999994540903614, 0.088387]
  cd(0:1, 45) = [-13.499974273092944, 0.081791]
  cd(0:1, 46) = [-13.000011301061788, 0.075195]
  cd(0:1, 47) = [-12.499991033251119, 0.068599]
  cd(0:1, 48) = [-12.000028061219961, 0.062003]
  cd(0:1, 49) = [-11.500007793409292, 0.055407]
  cd(0:1, 50) = [-10.999987525598621, 0.048811]
  cd(0:1, 51) = [-10.500024553567467, 0.042215]
  cd(0:1, 52) = [-10.000004285756797, 0.03562]
  cd(0:1, 53) = [-9.499984017946128, 0.029024]
  cd(0:1, 54) = [-9.000021045914972, 0.022428]
  cd(0:1, 55) = [-8.500000778104303, 0.017031]
  cd(0:1, 56) = [-7.999980510293632, 0.011634]
  cd(0:1, 57) = [-7.500017538262475, 0.010187]
  cd(0:1, 58) = [-6.999997270451807, 0.009]
  cd(0:1, 59) = [-6.499977002641137, 0.0076]
  cd(0:1, 60) = [-6.0000140306099805, 0.0072]
  cd(0:1, 61) = [-5.499993762799311, 0.0069]
  cd(0:1, 62) = [-4.999973494988642, 0.0067]
  cd(0:1, 63) = [-4.500010522957486, 0.0065]
  cd(0:1, 64) = [-3.999990255146816, 0.0064]
  cd(0:1, 65) = [-3.50002728311566, 0.0064]
  cd(0:1, 66) = [-3.0000070153049903, 0.0063]
  cd(0:1, 67) = [-2.499986747494321, 0.0063]
  cd(0:1, 68) = [-2.0000237754631645, 0.0063]
  cd(0:1, 69) = [-1.5000035076524951, 0.0063]
  cd(0:1, 70) = [-0.9999832398418258, 0.0063]
  cd(0:1, 71) = [-0.5000202678106694, 0.0063]
  cd(0:1, 72) = [0.0, 0.0064]
  cd(0:1, 73) = [0.5000202678106694, 0.0064]
  cd(0:1, 74) = [0.9999832398418258, 0.0064]
  cd(0:1, 75) = [1.5000035076524951, 0.0065]
  cd(0:1, 76) = [2.0000237754631645, 0.0065]
  cd(0:1, 77) = [2.499986747494321, 0.0066]
  cd(0:1, 78) = [3.0000070153049903, 0.0067]
  cd(0:1, 79) = [3.50002728311566, 0.0068]
  cd(0:1, 80) = [3.999990255146816, 0.0069]
  cd(0:1, 81) = [4.500010522957486, 0.007]
  cd(0:1, 82) = [4.999973494988642, 0.0071]
  cd(0:1, 83) = [5.499993762799311, 0.0073]
  cd(0:1, 84) = [6.0000140306099805, 0.0076]
  cd(0:1, 85) = [6.499977002641137, 0.0081]
  cd(0:1, 86) = [6.999997270451807, 0.009]
  cd(0:1, 87) = [7.500017538262475, 0.0105]
  cd(0:1, 88) = [7.999980510293632, 0.012]
  cd(0:1, 89) = [8.500000778104303, 0.0134]
  cd(0:1, 90) = [9.000021045914972, 0.0145]
  cd(0:1, 91) = [9.499984017946128, 0.0156]
  cd(0:1, 92) = [10.000004285756797, 0.0165]
  cd(0:1, 93) = [10.500024553567467, 0.0178]
  cd(0:1, 94) = [10.999987525598621, 0.0195]
  cd(0:1, 95) = [11.500007793409292, 0.0215]
  cd(0:1, 96) = [12.000028061219961, 0.035]
  cd(0:1, 97) = [12.499991033251119, 0.0485]
  cd(0:1, 98) = [13.000011301061788, 0.062]
  cd(0:1, 99) = [13.499974273092944, 0.0755]
  cd(0:1, 100) = [13.999994540903614, 0.089]
  cd(0:1, 101) = [14.99997778074544, 0.1025]
  cd(0:1, 102) = [16.000018316366777, 0.116]
  cd(0:1, 103) = [17.000001556208606, 0.1295]
  cd(0:1, 104) = [17.99998479605043, 0.143]
  cd(0:1, 105) = [19.000025331671768, 0.156402]
  cd(0:1, 106) = [20.000008571513593, 0.172346]
  cd(0:1, 107) = [21.999975051197243, 0.206247]
  cd(0:1, 108) = [23.99999882666041, 0.242691]
  cd(0:1, 109) = [26.000022602123575, 0.281501]
  cd(0:1, 110) = [27.99998908180723, 0.322487]
  cd(0:1, 111) = [30.000012857270395, 0.365449]
  cd(0:1, 112) = [31.999979336954045, 0.410179]
  cd(0:1, 113) = [34.00000311241721, 0.456458]
  cd(0:1, 114) = [36.00002688788037, 0.50406]
  cd(0:1, 115) = [37.999993367564024, 0.552754]
  cd(0:1, 116) = [40.000017143027186, 0.602301]
  cd(0:1, 117) = [44.99999063801583, 0.728313]
  cd(0:1, 118) = [50.00002142878399, 0.854311]
  cd(0:1, 119) = [54.999994923772626, 0.972686]
  cd(0:1, 120) = [60.00002571454079, 1.09106]
  cd(0:1, 121) = [64.99999920952942, 1.187505]
  cd(0:1, 122) = [69.99997270451807, 1.28395]
  cd(0:1, 123) = [75.00000349528622, 1.346815]
  cd(0:1, 124) = [79.99997699027486, 1.40968]
  cd(0:1, 125) = [85.00000778104302, 1.43137]
  cd(0:1, 126) = [89.99998127603166, 1.45306]
  cd(0:1, 127) = [95.00001206679983, 1.43137]
  cd(0:1, 128) = [99.99998556178845, 1.40968]
  cd(0:1, 129) = [105.0000163525566, 1.346815]
  cd(0:1, 130) = [109.99998984754525, 1.28395]
  cd(0:1, 131) = [115.0000206383134, 1.187505]
  cd(0:1, 132) = [119.99999413330205, 1.09106]
  cd(0:1, 133) = [125.00002492407022, 0.972686]
  cd(0:1, 134) = [129.99999841905884, 0.854311]
  cd(0:1, 135) = [134.99997191404748, 0.728306]
  cd(0:1, 136) = [140.00000270481564, 0.602301]
  cd(0:1, 137) = [144.9999761998043, 0.483875]
  cd(0:1, 138) = [150.00000699057244, 0.365449]
  cd(0:1, 139) = [154.99998048556108, 0.268898]
  cd(0:1, 140) = [160.00001127632925, 0.172346]
  cd(0:1, 141) = [164.99998477131788, 0.125383]
  cd(0:1, 142) = [170.00001556208605, 0.078419]
  cd(0:1, 143) = [174.99998905707469, 0.03921]
  cd(0:1, 144) = [179.96604345059157, 0.037696]
  
  IF ( y .EQ. cd(0,0) ) c7 = cd(1,0)
  DO i = 1,ns-1
     IF ( ( y .GT. cd(0,i-1) ) .AND. (y .LE. cd(0,i) ) ) THEN
        cd7 = cd(1,i-1) + (y - cd(0,i-1))*( ( cd(1,i) - cd(1,i-1) )/( cd(0,i) - cd(0,i-1) ) )
        GOTO 1
     ENDIF
  ENDDO
1 CONTINUE
  
  IF ( y .LT. cd(0,0) ) THEN
     cd7 = cd(1,0)
!     PRINT*,'alpha < tabulated range in calc_cd7_nrel28.pro'
  ENDIF
  IF ( y .GT. cd(0,ns-1) ) THEN
     cd7 = cd(1,ns-1)
!     PRINT*,'alpha > tabulated range in calc_cd7_nrel28.pro'
  ENDIF
!_________________________________________________________________________
  
END FUNCTION calc_cd7_nrel28
!_________________________________________________________________________


!_________________________________________________________________________
  
END MODULE module_gad_nrel28

