MODULE module_nonRot_gad_nrel5


CONTAINS

!===============================================================================
!
!  GE 5 MW Turbine
!
!===============================================================================

!=========================================================================

FUNCTION calc_ct_p_nrel5( x ) result( ct_p )

!_________________________________________________________________________
!
! Data from NREL 5 MW
! x =  wind speed
!_________________________________________________________________________


  REAL, INTENT( in ) :: x

  INTEGER, PARAMETER :: nws = 41

  REAL, DIMENSION( 0:nws-1 ) :: ws
  REAL, DIMENSION( 0:nws-1 ) :: CT
  REAL, DIMENSION( 0:nws-1 ) :: P


  real, dimension( 2 )  :: ct_p

  INTEGER :: i

  ct_p(1) = 0.0
  ct_p(2) = 0.0

! Wind speed

 ws(0) = 3
 ws(1) = 4
 ws(2) = 5
 ws(3) = 6
 ws(4) = 7
 ws(5) = 8
 ws(6) = 9
 ws(7) = 10
 ws(8) = 10.1
 ws(9) = 10.2
 ws(10) = 10.3
 ws(11) = 10.4
 ws(12) = 10.5
 ws(13) = 10.6
 ws(14) = 10.7
 ws(15) = 10.8
 ws(16) = 10.9
 ws(17) = 11
 ws(18) = 11.1
 ws(19) = 11.2
 ws(20) = 11.3
 ws(21) = 11.4
 ws(22) = 11.5
 ws(23) = 11.6
 ws(24) = 11.7
 ws(25) = 11.8
 ws(26) = 11.9
 ws(27) = 12
 ws(28) = 13
 ws(29) = 14
 ws(30) = 15
 ws(31) = 16
 ws(32) = 17
 ws(33) = 18
 ws(34) = 19
 ws(35) = 20
 ws(36) = 21
 ws(37) = 22
 ws(38) = 23
 ws(39) = 24
 ws(40) = 25


! Thrust coefficient
CT(0) = 2.497990
CT(1) = 1.766833
CT(2) = 1.408360
CT(3) = 1.201348
CT(4) = 1.065134
CT(5) = 0.977937
CT(6) = 0.936282
CT(7) = 0.905425
CT(8) = 0.902755
CT(9) = 0.900162
CT(10) = 0.895745
CT(11) = 0.889631
CT(12) = 0.883652
CT(13) = 0.877788
CT(14) = 0.872069
CT(15) = 0.866439
CT(16) = 0.860931
CT(17) = 0.855545
CT(18) = 0.850276
CT(19) = 0.845148
CT(20) = 0.840105
CT(21) = 0.811166
CT(22) = 0.764010
CT(23) = 0.728584
CT(24) = 0.698945
CT(25) = 0.672754
CT(26) = 0.649083
CT(27) = 0.627368
CT(28) = 0.471374
CT(29) = 0.372703
CT(30) = 0.302901
CT(31) = 0.251236
CT(32) = 0.211901
CT(33) = 0.181211
CT(34) = 0.156798
CT(35) = 0.137091
CT(36) = 0.120753
CT(37) = 0.106941
CT(38) = 0.095319
CT(39) = 0.085632
CT(40) = 0.077368

! Power
!P(0) = 40.500000
!P(1) = 177.700000
!P(2) = 403.900000
!P(3) = 737.600000
!P(4) = 1187.200000
!P(5) = 1771.100000
!P(6) = 2518.600000
!P(7) = 3448.410000
!P(8) = 3552.150000
!P(9) = 3657.950000
!P(10) = 3765.160000
!P(11) = 3873.950000
!P(12) = 3984.490000
!P(13) = 4096.560000
!P(14) = 4210.690000
!P(15) = 4326.150000
!P(16) = 4443.410000
!P(17) = 4562.510000
!P(18) = 4683.430000
!P(19) = 4806.180000
!P(20) = 4929.920000
!P(21) = 5000.370000
!P(22) = 5000.020000
!P(23) = 5000.000000
!P(24) = 4999.990000
!P(25) = 5000.000000
!P(26) = 5000.000000
!P(27) = 5000.000000
!P(28) = 5000.000000
!P(29) = 5000.000000
!P(30) = 5000.000000
!P(31) = 5000.000000
!P(32) = 5000.000000
!P(33) = 5000.000000
!P(34) = 5000.000000
!P(35) = 5000.000000
!P(36) = 5000.000000
!P(37) = 5000.000000
!P(38) = 5000.000000
!P(39) = 5000.000000
!P(40) = 5000.000000

! Power Coefficient
P(0) = 0.196406
P(1) = 0.363555
P(2) = 0.423084
P(3) = 0.447126
P(4) = 0.453203
P(5) = 0.452935
P(6) = 0.452371
P(7) = 0.451525
P(8) = 0.451430
P(9) = 0.451336
P(10) = 0.451164
P(11) = 0.450938
P(12) = 0.450679
P(13) = 0.450365
P(14) = 0.450054
P(15) = 0.449669
P(16) = 0.449262
P(17) = 0.448837
P(18) = 0.448392
P(19) = 0.447929
P(20) = 0.447371
P(21) = 0.441927
P(22) = 0.430468
P(23) = 0.419429
P(24) = 0.408766
P(25) = 0.398462
P(26) = 0.388501
P(27) = 0.378869
P(28) = 0.297991
P(29) = 0.238588
P(30) = 0.193981
P(31) = 0.159835
P(32) = 0.133256
P(33) = 0.112258
P(34) = 0.095449
P(35) = 0.081836
P(36) = 0.070693
P(37) = 0.061484
P(38) = 0.053808
P(39) = 0.047359
P(40) = 0.041900

  DO i = 1,nws-1
     
     IF ( ( x .GE. ws(i-1) ) .AND. ( x .LT. ws(i) ) ) THEN
        ct_p(1) = CT(i-1) + (x - ws(i-1))*( ( CT(i) - CT(i-1) )/( ws(i) - ws(i-1) ) )
        ct_p(2) = P(i-1) + (x - ws(i-1))*( ( P(i) - P(i-1) )/( ws(i) - ws(i-1) ) )
        GOTO 1
     ENDIF

  END DO
 
  IF ( x .LT. ws(0) ) THEN
      ct_p(1) = 0.0
      ct_p(2) = 0.0
  ENDIF

  IF ( x .GT. ws(nws-1) ) THEN
      ct_p(1) = 0.0
      ct_p(2) = 0.0
  ENDIF
 

1 CONTINUE
 
!_________________________________________________________________________

END FUNCTION calc_ct_p_nrel5
!_________________________________________________________________________
 


END MODULE module_nonRot_gad_nrel5

