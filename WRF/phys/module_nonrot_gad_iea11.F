MODULE module_nonrot_gad_iea11 


CONTAINS

!===============================================================================
!
!  IEA 11 MW Turbine
!  D = 206 m
!===============================================================================

!=========================================================================

FUNCTION calc_ct_p_iea11( x ) result( ct_p )

!_________________________________________________________________________
!
! Data from IEA 11 MW
! x =  wind speed
!_________________________________________________________________________


  REAL, INTENT( in ) :: x

  INTEGER, PARAMETER :: nws = 45

  REAL, DIMENSION( 0:nws-1 ) :: ws
  REAL, DIMENSION( 0:nws-1 ) :: CT
  REAL, DIMENSION( 0:nws-1 ) :: P


  real, dimension( 2 )  :: ct_p

  INTEGER :: i

  ct_p(1) = 0.0
  ct_p(2) = 0.0

! Wind speed
 ws(0) = 3.00
 ws(1) = 3.50
 ws(2) = 4.00
 ws(3) = 4.50
 ws(4) = 5.00
 ws(5) = 5.50
 ws(6) = 6.00
 ws(7) = 6.50
 ws(8) = 7.00
 ws(9) = 7.50
 ws(10) = 8.00
 ws(11) = 8.50
 ws(12) = 9.00
 ws(13) = 9.50
 ws(14) = 10.00
 ws(15) = 10.50
 ws(16) = 11.00
 ws(17) = 11.50
 ws(18) = 12.00
 ws(19) = 12.50
 ws(20) = 13.00
 ws(21) = 13.50
 ws(22) = 14.00
 ws(23) = 14.50
 ws(24) = 15.00
 ws(25) = 15.50
 ws(26) = 16.00
 ws(27) = 16.50
 ws(28) = 17.00
 ws(29) = 17.50
 ws(30) = 18.00
 ws(31) = 18.50
 ws(32) = 19.00
 ws(33) = 19.50
 ws(34) = 20.00
 ws(35) = 20.50
 ws(36) = 21.00
 ws(37) = 21.50
 ws(38) = 22.00
 ws(39) = 22.50
 ws(40) = 23.00
 ws(41) = 23.50
 ws(42) = 24.00
 ws(43) = 24.50
 ws(44) = 25.00

! Thrust coefficient
 CT(0) = 0.699000
 CT(1) = 0.787000
 CT(2) = 0.782000
 CT(3) = 0.785000
 CT(4) = 0.788000
 CT(5) = 0.790000
 CT(6) = 0.790000
 CT(7) = 0.789000
 CT(8) = 0.786000
 CT(9) = 0.778000
 CT(10) = 0.778000
 CT(11) = 0.778000
 CT(12) = 0.778000
 CT(13) = 0.778000
 CT(14) = 0.712000
 CT(15) = 0.646000
 CT(16) = 0.589000
 CT(17) = 0.510000
 CT(18) = 0.431000
 CT(19) = 0.370000
 CT(20) = 0.322000
 CT(21) = 0.283000
 CT(22) = 0.252000
 CT(23) = 0.225000
 CT(24) = 0.202000
 CT(25) = 0.182000
 CT(26) = 0.165000
 CT(27) = 0.150000
 CT(28) = 0.137000
 CT(29) = 0.126000
 CT(30) = 0.115000
 CT(31) = 0.106000
 CT(32) = 0.098000
 CT(33) = 0.091000
 CT(34) = 0.085000
 CT(35) = 0.079000
 CT(36) = 0.073000
 CT(37) = 0.069000
 CT(38) = 0.064000
 CT(39) = 0.060000
 CT(40) = 0.057000
 CT(41) = 0.053000
 CT(42) = 0.050000
 CT(43) = 0.048000
 CT(44) = 0.045000


! Power Coefficient
 P(0) = 0.049167
 P(1) = 0.220279
 P(2) = 0.311901
 P(3) = 0.364309
 P(4) = 0.395138
 P(5) = 0.415028
 P(6) = 0.427537
 P(7) = 0.433964
 P(8) = 0.438187
 P(9) = 0.440596
 P(10) = 0.442001
 P(11) = 0.442816
 P(12) = 0.442054
 P(13) = 0.441022
 P(14) = 0.420959
 P(15) = 0.395711
 P(16) = 0.362082
 P(17) = 0.354218
 P(18) = 0.311760
 P(19) = 0.275825
 P(20) = 0.245207
 P(21) = 0.218959
 P(22) = 0.196327
 P(23) = 0.176709
 P(24) = 0.159621
 P(25) = 0.144667
 P(26) = 0.131524
 P(27) = 0.119926
 P(28) = 0.109652
 P(29) = 0.100519
 P(30) = 0.092373
 P(31) = 0.085084
 P(32) = 0.078542
 P(33) = 0.072654
 P(34) = 0.067340
 P(35) = 0.062532
 P(36) = 0.058171
 P(37) = 0.054206
 P(38) = 0.050594
 P(39) = 0.047295
 P(40) = 0.044277
 P(41) = 0.041511
 P(42) = 0.038970
 P(43) = 0.036632
 P(44) = 0.034478

 ! Interpolate thrust and power coefficient to current wind speed
  DO i = 1,nws-1
     
     IF ( ( x .GE. ws(i-1) ) .AND. ( x .LT. ws(i) ) ) THEN
        ct_p(1) = CT(i-1) + (x - ws(i-1))*( ( CT(i) - CT(i-1) )/( ws(i) - ws(i-1) ) )
        ct_p(2) = P(i-1) + (x - ws(i-1))*( ( P(i) - P(i-1) )/( ws(i) - ws(i-1) ) )
        GOTO 1
     ENDIF

  END DO
 
  IF ( x .LT. ws(0) ) THEN
      ct_p(1) = 0.0
      ct_p(2) = 0.0
  ENDIF

  IF ( x .GT. ws(nws-1) ) THEN
      ct_p(1) = 0.0
      ct_p(2) = 0.0
  ENDIF
 

1 CONTINUE
 
!_________________________________________________________________________

END FUNCTION calc_ct_p_iea11 
!_________________________________________________________________________
 


END MODULE module_nonrot_gad_iea11 

