MODULE module_nonRot_gad_ge28


CONTAINS

!===============================================================================
!
!  GE 2.8 MW Turbine
!
!===============================================================================

!=========================================================================

FUNCTION calc_ct_p_ge28( x ) result( ct_p )

!_________________________________________________________________________
!
! Data from GE 2.8 MW
! x =  wind speed
!_________________________________________________________________________


  REAL, INTENT( in ) :: x

  REAL, PARAMETER :: nws = 30

  REAL, DIMENSION( 0:nws-1 ) :: ws
  REAL, DIMENSION( 0:nws-1 ) :: CT
  REAL, DIMENSION( 0:nws-1 ) :: P


  real, dimension( 2 )  :: ct_p

  INTEGER :: i

  ct_p(1) = 0.0
  ct_p(2) = 0.0

! Wind speed
  ws(0) = 3
  ws(1) = 3.889649963
  ws(2) = 4.684006997
  ws(3) = 5.377830234
  ws(4) = 5.966542092
  ws(5) = 6.446258474
  ws(6) = 6.813814392
  ws(7) = 7.066784852
  ws(8) = 7.203500851
  ws(9) = 7.223060389
  ws(10) = 7.320786359
  ws(11) = 7.535153079
  ws(12) = 7.864746237
  ws(13) = 8.307391303
  ws(14) = 8.860167873
  ws(15) = 9.519428937
  ws(16) = 10.28082494
  ws(17) = 10.68187298
  ws(18) = 11.13933248
  ws(19) = 12.08928745
  ws(20) = 13.1244224
  ws(21) = 14.23790791
  ws(22) = 15.42239763
  ws(23) = 16.67007674
  ws(24) = 17.97271352
  ws(25) = 19.32171368
  ws(26) = 20.70817701
  ws(27) = 22.12295617
  ws(28) = 23.55671697
  ws(29) = 25.0000000

! Thrust coefficient
  CT(0) = 1.012663948
  CT(1) = 0.840327937
  CT(2) = 0.796195935
  CT(3) = 0.796195935
  CT(4) = 0.796195935
  CT(5) = 0.796195935
  CT(6) = 0.796195935
  CT(7) = 0.796195935
  CT(8) = 0.796195935
  CT(9) = 0.796195935
  CT(10) = 0.796195935
  CT(11) = 0.796195935
  CT(12) = 0.796195935
  CT(13) = 0.715668353
  CT(14) = 0.629206751
  CT(15) = 0.54509121
  CT(16) = 0.467344212
  CT(17) = 0.432909911
  CT(18) = 0.372887358
  CT(19) = 0.283450122
  CT(20) = 0.218171192
  CT(21) = 0.16975065
  CT(22) = 0.133540825
  CT(23) = 0.106323153
  CT(24) = 0.085635741
  CT(25) = 0.069940268
  CT(26) = 0.057797679
  CT(27) = 0.048488975
  CT(28) = 0.04135735
  CT(29) = 0.03572262

! Power
  P(0) = 67.00225088
  P(1) = 178.9833513
  P(2) = 319.8745825
  P(3) = 488.9363817
  P(4) = 671.2189471
  P(5) = 848.8635893
  P(6) = 1004.040541
  P(7) = 1120.949018
  P(8) = 1187.696699
  P(9) = 1197.44835
  P(10) = 1246.975343
  P(11) = 1360.279481
  P(12) = 1547.294696
  P(13) = 1828.968952
  P(14) = 2097.214766
  P(15) = 2363.935854
  P(16) = 2646.964107
  P(17) = 2800
  P(18) = 2799.997076
  P(19) = 2799.99986
  P(20) = 2799.999999
  P(21) = 2800.030679
  P(22) = 2800.014972
  P(23) = 2800.010438
  P(24) = 2800.004715
  P(25) = 2800.006868
  P(26) = 2800.00634
  P(27) = 2800.001204
  P(28) = 2800.001877
  P(29) = 2800.000058

  DO i = 1,nws-1
     
     IF ( ( x .GE. ws(i-1) ) .AND. ( x .LT. ws(i) ) ) THEN
        ct_p(1) = CT(i-1) + (x - ws(i-1))*( ( CT(i) - CT(i-1) )/( ws(i) - ws(i-1) ) )
        ct_p(2) = P(i-1) + (x - ws(i-1))*( ( P(i) - P(i-1) )/( ws(i) - ws(i-1) ) )
        GOTO 1
     ENDIF

  END DO
 
  IF ( x .LT. ws(0) ) THEN
      ct_p(1) = 0.0
      ct_p(2) = 0.0
  ENDIF

  IF ( x .GT. ws(nws-1) ) THEN
      ct_p(1) = 0.0
      ct_p(2) = 0.0
  ENDIF
 

1 CONTINUE
 
!_________________________________________________________________________

END FUNCTION calc_ct_p_ge28
!_________________________________________________________________________
 


END MODULE module_nonRot_gad_ge28

