MODULE module_nonRot_gad_ge28


CONTAINS

!===============================================================================
!
!  GE 2.8 MW Turbine
!  D = 127 m
!===============================================================================

!=========================================================================

FUNCTION calc_ct_p_ge28( x ) result( ct_p )

!_________________________________________________________________________
!
! Data from GE 2.8 MW
! x =  wind speed
!_________________________________________________________________________


  REAL, INTENT( in ) :: x

  INTEGER, PARAMETER :: nws = 30

  REAL, DIMENSION( 0:nws-1 ) :: ws
  REAL, DIMENSION( 0:nws-1 ) :: CT
  REAL, DIMENSION( 0:nws-1 ) :: P


  real, dimension( 2 )  :: ct_p

  INTEGER :: i

  ct_p(1) = 0.0
  ct_p(2) = 0.0

! Wind speed
ws(0) = 3.000000
ws(1) = 3.889650
ws(2) = 4.684007
ws(3) = 5.377830
ws(4) = 5.966542
ws(5) = 6.446258
ws(6) = 6.813814
ws(7) = 7.066785
ws(8) = 7.203501
ws(9) = 7.223060
ws(10) = 7.320786
ws(11) = 7.535153
ws(12) = 7.864746
ws(13) = 8.307391
ws(14) = 8.860168
ws(15) = 9.519429
ws(16) = 10.280825
ws(17) = 10.681873
ws(18) = 11.139332
ws(19) = 12.089287
ws(20) = 13.124422
ws(21) = 14.237908
ws(22) = 15.422398
ws(23) = 16.670077
ws(24) = 17.972714
ws(25) = 19.321714
ws(26) = 20.708177
ws(27) = 22.122956
ws(28) = 23.556717
ws(29) = 25.000000

! Thrust coefficient
CT(0) = 1.012664
CT(1) = 0.840328
CT(2) = 0.796196
CT(3) = 0.796196
CT(4) = 0.796196
CT(5) = 0.796196
CT(6) = 0.796196
CT(7) = 0.796196
CT(8) = 0.796196
CT(9) = 0.796196
CT(10) = 0.796196
CT(11) = 0.796196
CT(12) = 0.796196
CT(13) = 0.715668
CT(14) = 0.629207
CT(15) = 0.545091
CT(16) = 0.467344
CT(17) = 0.432910
CT(18) = 0.372887
CT(19) = 0.283450
CT(20) = 0.218171
CT(21) = 0.169751
CT(22) = 0.133541
CT(23) = 0.106323
CT(24) = 0.085636
CT(25) = 0.069940
CT(26) = 0.057798
CT(27) = 0.048489
CT(28) = 0.041357
CT(29) = 0.035723

! Power coefficient
P(0) = 0.319832
P(1) = 0.391992
P(2) = 0.401166
P(3) = 0.405161
P(4) = 0.407280
P(5) = 0.408424
P(6) = 0.409051
P(7) = 0.409371
P(8) = 0.409516
P(9) = 0.409534
P(10) = 0.409620
P(11) = 0.409778
P(12) = 0.409935
P(13) = 0.411158
P(14) = 0.388610
P(15) = 0.353183
P(16) = 0.313950
P(17) = 0.296082
P(18) = 0.261082
P(19) = 0.204245
P(20) = 0.159630
P(21) = 0.125032
P(22) = 0.098379
P(23) = 0.077901
P(24) = 0.062160
P(25) = 0.050029
P(26) = 0.040638
P(27) = 0.033329
P(28) = 0.027606
P(29) = 0.023096

  DO i = 1,nws-1
     
     IF ( ( x .GE. ws(i-1) ) .AND. ( x .LT. ws(i) ) ) THEN
        ct_p(1) = CT(i-1) + (x - ws(i-1))*( ( CT(i) - CT(i-1) )/( ws(i) - ws(i-1) ) )
        ct_p(2) = P(i-1) + (x - ws(i-1))*( ( P(i) - P(i-1) )/( ws(i) - ws(i-1) ) )
        GOTO 1
     ENDIF

  END DO
 
  IF ( x .LT. ws(0) ) THEN
      ct_p(1) = 0.0
      ct_p(2) = 0.0
  ENDIF

  IF ( x .GT. ws(nws-1) ) THEN
      ct_p(1) = 0.0
      ct_p(2) = 0.0
  ENDIF
 

1 CONTINUE
 
!_________________________________________________________________________

END FUNCTION calc_ct_p_ge28
!_________________________________________________________________________
 


END MODULE module_nonRot_gad_ge28

